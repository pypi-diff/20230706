# Comparing `tmp/zhixuewang-1.1.7-py3-none-any.whl.zip` & `tmp/zhixuewang-1.1.8-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,33 +1,34 @@
-Zip file size: 33359 bytes, number of entries: 31
--rw-rw-rw-  2.0 fat      586 b- defN 22-May-05 14:40 zhixuewang/__init__.py
+Zip file size: 29350 bytes, number of entries: 32
+-rw-rw-rw-  2.0 fat      584 b- defN 23-Jul-06 13:58 zhixuewang/__init__.py
 -rw-rw-rw-  2.0 fat     4955 b- defN 22-Apr-29 09:52 zhixuewang/account.py
 -rw-rw-rw-  2.0 fat     3212 b- defN 22-May-01 14:27 zhixuewang/deleted.py
--rw-rw-rw-  2.0 fat     1203 b- defN 22-Apr-29 01:07 zhixuewang/exceptions.py
--rw-rw-rw-  2.0 fat    10888 b- defN 22-May-01 14:27 zhixuewang/models.py
--rw-rw-rw-  2.0 fat     4482 b- defN 22-Apr-29 09:52 zhixuewang/session.py
+-rw-rw-rw-  2.0 fat      945 b- defN 23-Jul-06 12:52 zhixuewang/exceptions.py
+-rw-rw-rw-  2.0 fat     8333 b- defN 23-Jul-06 13:49 zhixuewang/models.py
+-rw-rw-rw-  2.0 fat     4508 b- defN 23-Jul-06 13:50 zhixuewang/session.py
 -rw-rw-rw-  2.0 fat     2172 b- defN 22-May-01 14:27 zhixuewang/test_student.py
 -rw-rw-rw-  2.0 fat      375 b- defN 22-Apr-28 08:16 zhixuewang/urls.py
 -rw-rw-rw-  2.0 fat     8074 b- defN 22-Apr-28 05:41 zhixuewang/zxw.py
 -rw-rw-rw-  2.0 fat      630 b- defN 21-Jul-28 09:46 zhixuewang/__pycache__/__init__.cpython-37.pyc
--rw-rw-rw-  2.0 fat      111 b- defN 21-Jun-13 07:14 zhixuewang/student/__init__.py
+-rw-rw-rw-  2.0 fat       87 b- defN 23-Jul-06 13:22 zhixuewang/student/__init__.py
 -rw-rw-rw-  2.0 fat     2165 b- defN 21-Jun-13 07:13 zhixuewang/student/models.py
--rw-rw-rw-  2.0 fat    29296 b- defN 22-May-03 09:21 zhixuewang/student/student.py
--rw-rw-rw-  2.0 fat     2161 b- defN 22-May-03 07:08 zhixuewang/student/urls.py
+-rw-rw-rw-  2.0 fat    23129 b- defN 23-Jul-06 13:52 zhixuewang/student/student.py
+-rw-rw-rw-  2.0 fat     1984 b- defN 23-Jul-06 13:22 zhixuewang/student/urls.py
 -rw-rw-rw-  2.0 fat       94 b- defN 21-Jun-13 07:14 zhixuewang/teacher/__init__.py
--rw-rw-rw-  2.0 fat     8614 b- defN 22-Apr-29 15:27 zhixuewang/teacher/models.py
--rw-rw-rw-  2.0 fat    15591 b- defN 22-May-05 14:39 zhixuewang/teacher/teacher.py
+-rw-rw-rw-  2.0 fat      831 b- defN 23-Jul-06 13:27 zhixuewang/teacher/models.py
+-rw-rw-rw-  2.0 fat     5888 b- defN 23-Jul-06 13:53 zhixuewang/teacher/teacher.py
 -rw-rw-rw-  2.0 fat     5142 b- defN 22-May-04 14:37 zhixuewang/teacher/tools.py
 -rw-rw-rw-  2.0 fat     1045 b- defN 22-Apr-28 05:57 zhixuewang/teacher/urls.py
--rw-rw-rw-  2.0 fat       94 b- defN 21-Jul-28 09:57 zhixuewang/tools/__init__.py
+-rw-rw-rw-  2.0 fat       94 b- defN 23-Jul-06 13:49 zhixuewang/tools/__init__.py
 -rw-rw-rw-  2.0 fat      737 b- defN 22-Apr-29 01:04 zhixuewang/tools/account.py
 -rw-rw-rw-  2.0 fat      248 b- defN 22-Apr-29 09:52 zhixuewang/tools/cookies.py
 -rw-rw-rw-  2.0 fat      433 b- defN 20-Aug-05 14:04 zhixuewang/tools/datetime_tool.py
+-rw-rw-rw-  2.0 fat     2392 b- defN 22-Aug-22 10:53 zhixuewang/tools/excel_helper.py
 -rw-rw-rw-  2.0 fat     1475 b- defN 22-May-03 07:18 zhixuewang/tools/password_helper.py
 -rw-rw-rw-  2.0 fat      306 b- defN 22-May-04 14:47 zhixuewang/tools/rank.py
 -rw-rw-rw-  2.0 fat      236 b- defN 22-Apr-29 09:36 zhixuewang/tools/session.py
--rw-rw-rw-  2.0 fat     1085 b- defN 22-May-05 14:41 zhixuewang-1.1.7.dist-info/LICENSE
--rw-rw-rw-  2.0 fat      341 b- defN 22-May-05 14:41 zhixuewang-1.1.7.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 22-May-05 14:41 zhixuewang-1.1.7.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       11 b- defN 22-May-05 14:41 zhixuewang-1.1.7.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     2562 b- defN 22-May-05 14:41 zhixuewang-1.1.7.dist-info/RECORD
-31 files, 108416 bytes uncompressed, 29253 bytes compressed:  73.0%
+-rw-rw-rw-  2.0 fat     1085 b- defN 23-Jul-06 13:59 zhixuewang-1.1.8.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat      277 b- defN 23-Jul-06 13:59 zhixuewang-1.1.8.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-Jul-06 13:59 zhixuewang-1.1.8.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       11 b- defN 23-Jul-06 13:59 zhixuewang-1.1.8.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     2646 b- defN 23-Jul-06 13:59 zhixuewang-1.1.8.dist-info/RECORD
+32 files, 84185 bytes uncompressed, 25104 bytes compressed:  70.2%
```

## zipnote {}

```diff
@@ -63,32 +63,35 @@
 
 Filename: zhixuewang/tools/cookies.py
 Comment: 
 
 Filename: zhixuewang/tools/datetime_tool.py
 Comment: 
 
+Filename: zhixuewang/tools/excel_helper.py
+Comment: 
+
 Filename: zhixuewang/tools/password_helper.py
 Comment: 
 
 Filename: zhixuewang/tools/rank.py
 Comment: 
 
 Filename: zhixuewang/tools/session.py
 Comment: 
 
-Filename: zhixuewang-1.1.7.dist-info/LICENSE
+Filename: zhixuewang-1.1.8.dist-info/LICENSE
 Comment: 
 
-Filename: zhixuewang-1.1.7.dist-info/METADATA
+Filename: zhixuewang-1.1.8.dist-info/METADATA
 Comment: 
 
-Filename: zhixuewang-1.1.7.dist-info/WHEEL
+Filename: zhixuewang-1.1.8.dist-info/WHEEL
 Comment: 
 
-Filename: zhixuewang-1.1.7.dist-info/top_level.txt
+Filename: zhixuewang-1.1.8.dist-info/top_level.txt
 Comment: 
 
-Filename: zhixuewang-1.1.7.dist-info/RECORD
+Filename: zhixuewang-1.1.8.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## zhixuewang/__init__.py

```diff
@@ -1,10 +1,10 @@
 __author__ = "anwenhu"
-__date__ = "2022/5/5 22:40"
-__version__ = "1.1.7"
+__date__ = "2023/7/7 7:7"
+__version__ = "1.1.8"
 
 from zhixuewang.account import (login, login_id, rewrite_str, login_student, login_teacher,
                             login_student_id, login_teacher_id, load_account)
 from zhixuewang.session import get_session, get_session_id
 VERSION = tuple(map(int, __version__.split('.')))
 __all__ = [
     "login",
```

## zhixuewang/exceptions.py

```diff
@@ -36,14 +36,7 @@
 
 
 class PageConnectionError(Error):
     def __init__(self, value):
         self.value = value
 
 
-class PageInformationError(Error):
-    def __init__(self, value):
-        self.value = value
-
-class GetOriginalError(Error):
-    def __init__(self, error_code: int, error_info: str):
-        self.value = f"获取原卷错误:{error_info}({error_code})"
```

## zhixuewang/models.py

```diff
@@ -1,55 +1,57 @@
 import base64
 from enum import Enum
+import os
 import pickle
 from typing import List, Callable, Union, TypeVar
 from dataclasses import dataclass, field
-from zhixuewang.session import get_session
+from zhixuewang.session import get_basic_session, get_session
 from zhixuewang.tools.datetime_tool import get_property
-from zhixuewang.tools.cookies import get_username_from_session
-from zhixuewang.tools.cookies import get_password_from_session
 from zhixuewang.urls import Url
 
 
 class Role(Enum):
-    student = 0,
+    student = (0,)
     teacher = 1
 
 
-
 @dataclass
 class AccountData:
     username: str
     encoded_password: str
     role: Role
 
+
 class Account:
     def __init__(self, session, role: Role) -> None:
         self._session = session
         self.role = role
-        self.username = get_username_from_session(session)
+        self.username = base64.b64decode(session.cookies["uname"].encode()).decode()
 
     def save_account(self, path: str = "user.data"):
         with open(path, "wb") as f:
-            data = pickle.dumps(AccountData(self.username, get_password_from_session(self._session), self.role))
+            password = base64.b64decode(self._session.cookies["pwd"].encode()).decode()
+            data = pickle.dumps(
+                AccountData(
+                    self.username, password, self.role
+                )
+            )
             f.write(base64.b64encode(data))
-    
 
     def update_login_status(self):
         """更新登录状态. 如果session过期自动重新获取"""
         r = self._session.get(Url.GET_LOGIN_STATE)
         data = r.json()
         if data["result"] == "success":
             return
         # session过期
-        password = get_password_from_session(self._session)
+        password = base64.b64decode(self._session.cookies["pwd"].encode()).decode()
         self._session = get_session(self.username, password)
 
 
-
 T = TypeVar("T")
 
 
 class ExtendedList(List[T]):
     """扩展列表, 方便找到列表里的元素"""
 
     def __init__(self, l: List[T] = list()):
@@ -86,105 +88,97 @@
 
     def find_all_by_id(self, id: str) -> "ExtendedList[T]":
         """返回列表里所有特定id的元素"""
         return self.find_all(lambda d: d.id == id)
 
 
 @dataclass
-class Phase:
-    """学期, 比如七年级, 八年级"""
-    name: str = ""
-    code: str = ""
-
-
-@dataclass
 class Grade:
     """年级"""
+
     name: str = ""
     code: str = ""
-    phase: Phase = field(default_factory=Phase)
+    phase_name: str = ""
+    phase_code: str = ""
 
 
 @dataclass
 class School:
     """学校"""
+
     id: str = ""
     name: str = ""
 
     def __str__(self):
         return self.name
 
 
 class Sex(Enum):
     """性别"""
+
     GIRL = "女"
     BOY = "男"
 
     def __str__(self):
         return self._value_
 
 
 @dataclass(eq=False)
 class StuClass:
     """班级"""
+
     id: str = ""
     name: str = ""
     grade: Grade = field(default_factory=Grade, repr=False)
     school: School = field(default_factory=School, repr=False)
 
     def __eq__(self, other):
         return type(other) == type(self) and other.id == self.id
 
     def __str__(self):
         return f"学校: {self.school} 班级: {self.name}"
 
-    def __repr__(self):
-        return f"StuClass(id={self.id}, name={self.name}, school={self.school.__repr__()})"
-
 
 @dataclass(repr=False)
 class Person:
     """一些基本属性"""
+
     id: str = ""
     name: str = ""
     gender: Sex = Sex.GIRL
-    email: str = ""
     mobile: str = ""
-    qq_number: str = ""
-    _birthday_timestamp: float = 0
-    birthday = get_property("_birthday_timestamp")
     avatar: str = ""
 
 
 @dataclass(repr=False)
 class StuPerson(Person):
     """一些关于学生的信息"""
+
     code: str = ""
     clazz: StuClass = field(default_factory=StuClass, repr=False)
-    
 
     def __str__(self):
-        return f"{self.clazz} 姓名: {self.name} 性别: {self.gender} " \
-               f"{f'QQ: {self.qq_number} ' if self.qq_number != '' else ''}" \
-               f"{f'手机号码: {self.mobile}' if self.mobile != '' else ''}"
+        return (
+            f"{self.clazz} 姓名: {self.name} 性别: {self.gender} "
+            f"{f'手机号码: {self.mobile}' if self.mobile != '' else ''}"
+        )
 
-    def __repr__(self):
-        return f"Person(id={self.id}, clazz={self.clazz.__repr__()}, name={self.name}, gender={self.gender}" \
-               f"{f', qq_number={self.qq_number}' if self.qq_number != '' else ''}" \
-               f"{f', mobile={self.mobile}' if self.mobile != '' else ''}" + ")"
 
 @dataclass
 class BasicSubject:
     """学科基本信息"""
+
     name: str = ""
     code: str = ""
-    
+
+
 @dataclass(eq=False)
 class Subject(BasicSubject):
     """学科"""
+
     id: str = ""
     standard_score: float = 0
     status: str = field(default="", repr=False)
     exam_id: str = field(default="", repr=False)
     create_user: Person = field(default_factory=Person, repr=False)
     _create_timestamp: float = field(default=0, repr=False)
     create_time = get_property("_create_timestamp")
@@ -192,170 +186,126 @@
     def __eq__(self, other):
         return type(other) == type(self) and other.id == self.id
 
 
 @dataclass(eq=False)
 class Exam:
     """考试"""
+
     id: str = ""
     name: str = ""
     status: str = ""
     grade_code: str = ""
     subjects: ExtendedList[Subject] = field(default_factory=ExtendedList, repr=False)
     schools: ExtendedList[School] = field(default_factory=ExtendedList, repr=False)
-    create_school: School = field(default_factory=School, repr=False)
     create_user: Person = field(default_factory=Person, repr=False)
     _create_timestamp: float = field(default=0, repr=False)
     create_time = get_property("_create_timestamp")
-    _exam_timestamp: float = field(default=0, repr=False)
-    exam_time = get_property("_exam_timestamp")
-    _complete_timestamp: float = field(default=0, repr=False)
-    complete_time = get_property("_complete_timestamp")
     class_rank: int = field(default=0, repr=False)
     grade_rank: int = field(default=0, repr=False)
     is_final: bool = False
 
     def __bool__(self):
         return bool(self.id)
 
     def __eq__(self, other):
         return type(other) == type(self) and other.id == self.id
 
 
-
-@dataclass(eq=False)
-class ExamInfo(Exam):
-    classId: str = ""
-    subjects: ExtendedList[Subject] = field(default_factory=ExtendedList, repr=False)
-
-
 @dataclass
 class SubjectScore:
     """一门学科的成绩"""
+
     score: float = 0
     subject: Subject = field(default_factory=Subject)
     person: StuPerson = field(default_factory=StuPerson)
-    _create_timestamp: float = field(default=0, repr=False)
-    create_time = get_property("_create_timestamp")
     class_rank: int = field(default_factory=int, compare=False)
     grade_rank: int = field(default_factory=int, compare=False)
     exam_rank: int = field(default_factory=int, compare=False)
 
     def __str__(self) -> str:
-        if self.person.id == "": #mark
+        if self.person.id == "":  # mark
             data = f"{self.subject.name}: {self.score}"
             if self.class_rank != 0:
                 data += f" (班级第{self.class_rank}名)"
             return data
         return self.__repr__()
 
 
-
 class Mark(ExtendedList[SubjectScore]):
     """一场考试的成绩"""
 
-    def __init__(self, l: list = list(), exam: Exam = Exam(), person: StuPerson = StuPerson()):
+    def __init__(
+        self, l: list = list(), exam: Exam = Exam(), person: StuPerson = StuPerson()
+    ):
         super().__init__(l)
         self.exam = exam
         self.person = person
 
     def __repr__(self):
         if self.exam and self.person:
-            msg = f"{self.person.name}-{self.exam.name}\n" + \
-                "".join([f"{subject}\n" for subject in self])
+            msg = f"{self.person.name}-{self.exam.name}\n" + "".join(
+                [f"{subject}\n" for subject in self]
+            )
             return msg[:-1]
 
     def __str__(self):
         return self.__repr__()
 
 
-
-class StuPersonList(ExtendedList):
-    """学生列表"""
-
-    def find_by_code(self, code: str) -> StuPerson:
-        """返回第一个准考证号为code的学生"""
-        return self.find(lambda p: p.code == code)
-
-    def find_by_clazz_id(self, clazz_id: str) -> StuPerson:
-        """返回第一个班级id为clazz_id的学生"""
-        return self.find(lambda p: p.clazz.id == clazz_id)
-
-    def find_all_by_clazz_id(self, clazz_id: str) -> ExtendedList[StuPerson]:
-        """返回所有班级id为clazz_id的学生"""
-        return self.find_all(lambda p: p.clazz.id == clazz_id)
-
-    def find_by_clazz(self, clazz: StuClass) -> StuPerson:
-        """返回第一个班级为clazz的学生"""
-        return self.find(lambda p: p.clazz == clazz)
-
-    def find_all_by_clazz(self, clazz: StuClass) -> ExtendedList[StuPerson]:
-        """返回所有班级为clazz的学生"""
-        return self.find_all(lambda p: p.clazz == clazz)
-
-    def find_by_school_id(self, school_id: str) -> StuPerson:
-        """返回第一个学校id为school_id的学生"""
-        return self.find(lambda p: p.school.id == school_id)
-
-    def find_by_school(self, school: School) -> StuPerson:
-        """返回第一个学校为school的学生"""
-        return self.find(lambda p: p.school == school)
-
 @dataclass
 class HwType:
     """作业类型, eg: 105 自由出题"""
+
     name: str
     code: int
 
-@dataclass
-class HwAnsPubData:
-    """作业答案发布信息, 如: 2-学生提交后公布"""
-    name: str
-    code: int 
 
 @dataclass
 class Homework:
     id: str
-    title: str
-    type: HwType
-    begin_time: int
-    end_time: int
-    create_time: int
-    subject: BasicSubject
-    is_allow_makeup: bool  # 是否允许重做
-    class_id: str
-    ansPubData: HwAnsPubData
+    title: str = ""
+    type: HwType = field(default_factory=HwType)
+    begin_time: int = 0
+    end_time: int = 0
+    create_time: int = 0
+    subject_name: str = ""
+    is_allow_makeup: bool = False  # 是否允许重做
+    class_id: str = ""
+
 
 @dataclass
 class StuHomework(Homework):
-    stu_hwid: str
-    # is_commit: bool # 是否提交作业
-    # is_finished: bool # 是否完成?
-    # is_dued: bool # 是否过期
+    stu_hwid: str = ""
 
-    # ...
 
 @dataclass
 class HwResource:
     path: str
     name: str
 
+    def download(self, path: str):
+        r = get_basic_session().get(self.path)
+        with open(os.path.join(path, self.name), "wb") as f:
+            f.write(r.content)
+
+
 @dataclass
 class ErrorBookTopic:
     analysis_html: str
     answer_html: str
     answer_type: str
     is_correct: bool
     class_score_rate: float
     content_html: str
     difficulty: int
     dis_title_number: str
     paper_id: str
     subject_name: str
     score: float
-    standard_answer: str # 网址
+    standard_answer: str  # 网址
     standard_score: float
     subject_id: str
-    topic_img_url: str # 好看的题目
+    topic_img_url: str  # 好看的题目
     topic_source_paper_name: str
-    image_answer: List[str] # 你的答案
-    topic_analysis_img_url: str
+    image_answer: List[str]  # 你的答案
+    topic_analysis_img_url: str
```

## zhixuewang/session.py

```diff
@@ -1,21 +1,22 @@
-
 import json
 import requests
 from zhixuewang.exceptions import LoginError, UserNotFoundError, UserOrPassError
-from zhixuewang.tools.password_helper import base64_encode, encode_password
-
+import base64
 from zhixuewang.urls import Url
 
+
 def get_basic_session() -> requests.Session:
     session = requests.Session()
     session.headers[
-        "User-Agent"] = "Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1"
+        "User-Agent"
+    ] = "Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1"
     return session
 
+
 def get_session(username: str, password: str, _type: str = "auto") -> requests.Session:
     """通过用户名和密码获取session
 
     默认可支持zx, zxt和tch开头的账号, 准考证号以及手机号
     可通过改变type为id来支持使用用户id
 
     Args:
@@ -28,51 +29,64 @@
         UserNotFoundError: 未找到用户
         LoginError: 登录错误
 
     Returns:
         requests.session:
     """
     if len(password) != 32:
-        password = encode_password(password)
+        password = (
+            pow(
+                int.from_bytes(password.encode()[::-1], "big"),
+                65537,
+                186198350384465244738867467156319743461,
+            )
+            .to_bytes(16, "big")
+            .hex()
+        )  ### by immoses648
     session = get_basic_session()
     r = session.get(Url.SSO_URL)
     json_obj = json.loads(r.text.strip().replace("\\", "").replace("'", "")[1:-1])
     if json_obj["code"] != 1000:
         raise LoginError(json_obj["data"])
     lt = json_obj["data"]["lt"]
     execution = json_obj["data"]["execution"]
-    r = session.get(Url.SSO_URL,
-                    params={
-                        "encode": "true",
-                        "sourceappname": "tkyh,tkyh",
-                        "_eventId": "submit",
-                        "appid": "zx-container-client",
-                        "client": "web",
-                        "type": "loginByNormal",
-                        "key": _type,
-                        "lt": lt,
-                        "execution": execution,
-                        "customLogoutUrl": "https://www.zhixue.com/login.html",
-                        "username": username,
-                        "password": password
-                    })
+    r = session.get(
+        Url.SSO_URL,
+        params={
+            "encode": "true",
+            "sourceappname": "tkyh,tkyh",
+            "_eventId": "submit",
+            "appid": "zx-container-client",
+            "client": "web",
+            "type": "loginByNormal",
+            "key": _type,
+            "lt": lt,
+            "execution": execution,
+            "customLogoutUrl": "https://www.zhixue.com/login.html",
+            "username": username,
+            "password": password,
+        },
+    )
     json_obj = json.loads(r.text.strip().replace("\\", "").replace("'", "")[1:-1])
     if json_obj["code"] != 1001:
         if json_obj["code"] == 1002:
             raise UserOrPassError()
         if json_obj["code"] == 2009:
             raise UserNotFoundError()
         raise LoginError(json_obj["data"])
     ticket = json_obj["data"]["st"]
-    session.post(Url.SERVICE_URL, data={
-        "action": "login",
-        "ticket": ticket,
-    })
-    session.cookies.set("uname", base64_encode(username))
-    session.cookies.set("pwd", base64_encode(password))
+    session.post(
+        Url.SERVICE_URL,
+        data={
+            "action": "login",
+            "ticket": ticket,
+        },
+    )
+    session.cookies.set("uname", base64.b64encode(username.encode()).decode())
+    session.cookies.set("pwd", base64.b64encode(password.encode()).decode())
     return session
 
 
 def get_session_id(user_id: str, password: str) -> requests.Session:
     """通过用户id和密码获取session
 
     Args:
@@ -101,32 +115,32 @@
         UserOrPassError: 用户名或密码错误
 
     Returns:
         str: 用户id
     """
     session = requests.Session()
     session.headers[
-        "User-Agent"] = "Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1"
-    r = session.post(Url.TEST_PASSWORD_URL,
-                     data={
-                         "loginName": username,
-                         "password": password,
-                         "code": ""
-                     })
+        "User-Agent"
+    ] = "Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1"
+    r = session.post(
+        Url.TEST_PASSWORD_URL,
+        data={"loginName": username, "password": password, "code": ""},
+    )
     json_obj = r.json()  # {"data": ErrorMsg, "result": StatusCode}
     if json_obj.get("data"):
         return json_obj["data"]
     if json_obj["result"] != "success":
         raise UserOrPassError()
     return ""
 
+
 def check_is_student(s: requests.Session) -> bool:
     """判断用户是否为学生
 
     Args:
         s (requests.session): session
 
     Returns:
         bool:
     """
     url = s.get("https://www.zhixue.com/container/container/index/").url
-    return "student" in url
+    return "student" in url
```

## zhixuewang/student/__init__.py

```diff
@@ -1,3 +1,3 @@
-from zhixuewang.student.student import StudentAccount, FriendMsg
+from zhixuewang.student.student import StudentAccount
 
-__all__ = ["StudentAccount", "FriendMsg"]
+__all__ = ["StudentAccount"]
```

## zhixuewang/student/student.py

```diff
@@ -1,119 +1,123 @@
 import hashlib
 import json
 import math
 import time
 import uuid
-from enum import IntEnum
 from typing import List, Tuple, Union
-from zhixuewang.models import (Account, BasicSubject, ErrorBookTopic, ExtendedList, Exam, HwAnsPubData, HwResource, HwType, Mark, Role, StuHomework, Subject, SubjectScore,
-                               StuClass, School, Sex, Grade, Phase, ExamInfo,
-                               StuPerson, StuPersonList)
-from zhixuewang.exceptions import GetOriginalError, UserDefunctError, PageConnectionError, PageInformationError
+from zhixuewang.models import (
+    Account,
+    BasicSubject,
+    ErrorBookTopic,
+    ExtendedList,
+    Exam,
+    HwResource,
+    HwType,
+    Mark,
+    Role,
+    StuHomework,
+    Subject,
+    SubjectScore,
+    StuClass,
+    School,
+    Sex,
+    Grade,
+    StuPerson,
+)
+from zhixuewang.exceptions import (
+    UserDefunctError,
+    PageConnectionError,
+)
 from zhixuewang.student.urls import Url
-from json import JSONDecodeError
 
 
 def _check_is_uuid(msg: str):
     """判断msg是否为uuid"""
-    return len(msg) == 36 and msg[14] == "4" and msg[8] == msg[13] == msg[18] == msg[23] == "-"
+    return (
+        len(msg) == 36
+        and msg[14] == "4"
+        and msg[8] == msg[13] == msg[18] == msg[23] == "-"
+    )
 
 
 def _md5_encode(msg: str) -> str:
     md5 = hashlib.md5()
     md5.update(msg.encode(encoding="utf-8"))
     return md5.hexdigest()
 
 
-class FriendMsg(IntEnum):
-    SUCCESS = 200  # 邀请成功
-    ALREADY = 201  # 已发送过邀请，等待对方答复
-    UNDEFINED = 202  # 未知错误
-
 
 class StudentAccount(Account, StuPerson):
     """学生账号"""
 
     def __init__(self, session):
         super().__init__(session, Role.student)
         self._token_timestamp = ["", 0]
         self.exams: ExtendedList[Exam] = ExtendedList()
 
     def _get_auth_header(self) -> dict:
         """获取header"""
         self.update_login_status()
         auth_guid = str(uuid.uuid4())
         auth_time_stamp = str(int(time.time() * 1000))
-        auth_token = _md5_encode(auth_guid + auth_time_stamp +
-                                 "iflytek!@#123student")
+        auth_token = _md5_encode(auth_guid + auth_time_stamp + "iflytek!@#123student")
         token, cur_time = self._token_timestamp
         if token and time.time() - cur_time < 600:  # 判断token是否过期
             return {
                 "authbizcode": "0001",
                 "authguid": auth_guid,
                 "authtimestamp": auth_time_stamp,
                 "authtoken": auth_token,
-                "XToken": token
+                "XToken": token,
             }
-        r = self._session.get(Url.XTOKEN_URL, headers={
-            "authbizcode": "0001",
-            "authguid": auth_guid,
-            "authtimestamp": auth_time_stamp,
-            "authtoken": auth_token
-        })
+        r = self._session.get(
+            Url.XTOKEN_URL,
+            headers={
+                "authbizcode": "0001",
+                "authguid": auth_guid,
+                "authtimestamp": auth_time_stamp,
+                "authtoken": auth_token,
+            },
+        )
         if not r.ok:
-            raise PageConnectionError(
-                f"_get_auth_header中出错, 状态码为{r.status_code}")
-        try:
-            if r.json()["errorCode"] != 0:
-                raise PageInformationError(
-                    f"_get_auth_header出错, 错误信息为{r.json()['errorInfo']}")
-            self._token_timestamp[0] = r.json()["result"]
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"_get_auth_header中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
+            raise PageConnectionError(f"_get_auth_header中出错, 状态码为{r.status_code}")
+        self._token_timestamp[0] = r.json()["result"]
         self._token_timestamp[1] = time.time()
         return self._get_auth_header()
 
     def set_base_info(self):
         """设置账户基本信息, 如用户id, 姓名, 学校等"""
         self.update_login_status()
         r = self._session.get(Url.INFO_URL)
         if not r.ok:
             raise PageConnectionError(f"set_base_info出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()["student"]
-            if not json_data.get("clazz", False):
-                raise UserDefunctError()
-            self.code = json_data.get("code")
-            self.name = json_data.get("name")
-            self.avatar = json_data.get("avatar")
-            self.gender = Sex.BOY if json_data.get(
-                "gender") == "1" else Sex.GIRL
-            self.username = json_data.get("loginName")
-            self.id = json_data.get("id")
-            self.mobile = json_data.get("mobile")
-            self.email = json_data.get("email")
-            self.qq_number = json_data.get("im")
-            self.clazz = StuClass(
-                id=json_data["clazz"]["id"],
-                name=json_data["clazz"]["name"],
-                school=School(
-                    id=json_data["clazz"]["division"]["school"]["id"],
-                    name=json_data["clazz"]["division"]["school"]["name"]),
-                grade=Grade(code=json_data["clazz"]["division"]["grade"]["code"],
-                            name=json_data["clazz"]["division"]["grade"]["name"],
-                            phase=Phase(code=json_data["clazz"]["division"]
-                                        ["grade"]["phase"]["code"],
-                                        name=json_data["clazz"]["division"]
-                                        ["grade"]["phase"]["name"])))
-            self.birthday = json_data.get("birthday", 0)
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"set_base_info中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
+        json_data = r.json()["student"]
+        if not json_data.get("clazz", False):
+            raise UserDefunctError()
+        self.code = json_data.get("code")
+        self.name = json_data.get("name")
+        self.avatar = json_data.get("avatar")
+        self.gender = Sex.BOY if json_data.get("gender") == "1" else Sex.GIRL
+        self.username = json_data.get("loginName")
+        self.id = json_data.get("id")
+        self.mobile = json_data.get("mobile")
+        self.clazz = StuClass(
+            id=json_data["clazz"]["id"],
+            name=json_data["clazz"]["name"],
+            school=School(
+                id=json_data["clazz"]["division"]["school"]["id"],
+                name=json_data["clazz"]["division"]["school"]["name"],
+            ),
+            grade=Grade(
+                code=json_data["clazz"]["division"]["grade"]["code"],
+                name=json_data["clazz"]["division"]["grade"]["name"],
+                phase_code=json_data["clazz"]["division"]["grade"]["phase"]["code"],
+                phase_name=json_data["clazz"]["division"]["grade"]["phase"]["name"],
+            ),
+        )
         return self
 
     def get_exam(self, exam_data: Union[Exam, str] = "") -> Exam:
         """获取考试
 
         Args:
             exam_data (Union[Exam, str]): 考试id 或 考试名称, 为Exam实例时直接返回, 为默认值时返回最新考试
@@ -137,76 +141,62 @@
             exam = exams.find_by_name(exam_data)
         return exam
 
     def get_page_exam(self, page_index: int) -> Tuple[ExtendedList[Exam], bool]:
         """获取指定页数的考试列表"""
         self.update_login_status()
         exams: ExtendedList[Exam] = ExtendedList()
-        r = self._session.get(Url.GET_EXAM_URL,
-                              params={
-                                  "pageIndex": page_index,
-                                  "pageSize": 10
-                              },
-                              headers=self._get_auth_header())
-        if not r.ok:
-            raise PageConnectionError(
-                f"get_page_exam中出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()["result"]
-            for exam_data in json_data["examList"]:
-                exam = Exam(
-                    id=exam_data["examId"],
-                    name=exam_data["examName"]
-                )
-                exam.create_time = exam_data["examCreateDateTime"]
-                exams.append(exam)
-            hasNextPage: bool = json_data["hasNextPage"]
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"get_page_exam中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
+        r = self._session.get(
+            Url.GET_EXAM_URL,
+            params={"pageIndex": page_index, "pageSize": 10},
+            headers=self._get_auth_header(),
+        )
+        if not r.ok:
+            raise PageConnectionError(f"get_page_exam中出错, 状态码为{r.status_code}")
+        json_data = r.json()["result"]
+        for exam_data in json_data["examList"]:
+            exam = Exam(id=exam_data["examId"], name=exam_data["examName"])
+            exam.create_time = exam_data["examCreateDateTime"]
+            exams.append(exam)
+        hasNextPage: bool = json_data["hasNextPage"]
         return exams, hasNextPage
 
-    def get_latest_exam(self) -> ExamInfo:
+    def get_latest_exam(self) -> Exam:
         """获取最新考试"""
         self.update_login_status()
-        r = self._session.get(Url.GET_RECENT_EXAM_URL,
-                              headers=self._get_auth_header())
+        r = self._session.get(Url.GET_RECENT_EXAM_URL, headers=self._get_auth_header())
         if not r.ok:
-            raise PageConnectionError(
-                f"get_latest_exam中出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()["result"]
-            exam_info_data = json_data["examInfo"]
+            raise PageConnectionError(f"get_latest_exam中出错, 状态码为{r.status_code}")
+        json_data = r.json()["result"]
+        exam_info_data = json_data["examInfo"]
 
-            subjects: ExtendedList[Subject] = ExtendedList()
+        subjects: ExtendedList[Subject] = ExtendedList()
 
-            for subject_data in exam_info_data["subjectScores"]:
-                subjects.append(Subject(
+        for subject_data in exam_info_data["subjectScores"]:
+            subjects.append(
+                Subject(
                     id=subject_data["topicSetId"],
                     name=subject_data["subjectName"],
-                    code=subject_data["subjectCode"]
-                ))
-
-            exam_info = ExamInfo(
-                id=exam_info_data["examId"],
-                name=exam_info_data["examName"],
-                subjects=subjects,
-                classId=exam_info_data["classId"],
-                grade_code=json_data["gradeCode"],
-                is_final=exam_info_data["isFinal"]
+                    code=subject_data["subjectCode"],
+                )
             )
-            exam_info.create_time = exam_info_data["examCreateDateTime"]
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"get_latest_exam中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
-        return exam_info
+
+        exam = Exam(
+            id=exam_info_data["examId"],
+            name=exam_info_data["examName"],
+            subjects=subjects,
+            grade_code=json_data["gradeCode"],
+            is_final=exam_info_data["isFinal"],
+        )
+        exam.create_time = exam_info_data["examCreateDateTime"]
+        return exam
 
     def get_exams(self) -> ExtendedList[Exam]:
         """获取所有考试"""
-        
+
         # 缓存
         if len(self.exams) > 0:
             latest_exam = self.get_latest_exam()
             if self.exams[0].id == latest_exam.id:
                 return self.exams
 
         exams: ExtendedList[Exam] = ExtendedList()
@@ -218,64 +208,60 @@
             i += 1
         self.exams = exams
         return exams
 
     def __get_self_mark(self, exam: Exam, has_total_score: bool) -> Mark:
         self.update_login_status()
         mark = Mark(exam=exam, person=self)
-        r = self._session.get(Url.GET_MARK_URL,
-                              params={"examId": exam.id},
-                              headers=self._get_auth_header())
+        r = self._session.get(
+            Url.GET_MARK_URL,
+            params={"examId": exam.id},
+            headers=self._get_auth_header(),
+        )
         if not r.ok:
-            raise PageConnectionError(
-                f"__get_self_mark中出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()
-            json_data = json_data["result"]
-            # exam.name = json_data["total_score"]["examName"]
-            # exam.id = json_data["total_score"]["examId"]
-            for subject in json_data["paperList"]:
-                subject_score = SubjectScore(
-                    score=subject["userScore"],
-                    subject=Subject(
-                        id=subject["paperId"],
-                        name=subject["subjectName"],
-                        code=subject["subjectCode"],
-                        standard_score=subject["standardScore"],
-                        exam_id=exam.id),
-                    person=StuPerson()
-                )
-                # subject_score.create_time = 0
-                mark.append(subject_score)
-            total_score = json_data.get("totalScore")
-            if has_total_score and total_score:
-                subject_score = SubjectScore(
-                    score=total_score["userScore"],
-                    subject=Subject(
-                        id="",
-                        name=total_score["subjectName"],
-                        code="99",
-                        standard_score=total_score["standardScore"],
-                        exam_id=exam.id,
-                    ),
-                    person=StuPerson(),
-                    class_rank=exam.class_rank,
-                    grade_rank=exam.grade_rank
-                )
-                # subject_score.create_time = 0
-                mark.append(subject_score)
-            self._set_exam_rank(mark)
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"__get_self_mark中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
+            raise PageConnectionError(f"__get_self_mark中出错, 状态码为{r.status_code}")
+        json_data = r.json()
+        json_data = json_data["result"]
+        # exam.name = json_data["total_score"]["examName"]
+        # exam.id = json_data["total_score"]["examId"]
+        for subject in json_data["paperList"]:
+            subject_score = SubjectScore(
+                score=subject["userScore"],
+                subject=Subject(
+                    id=subject["paperId"],
+                    name=subject["subjectName"],
+                    code=subject["subjectCode"],
+                    standard_score=subject["standardScore"],
+                    exam_id=exam.id,
+                ),
+                person=StuPerson(),
+            )
+            mark.append(subject_score)
+        total_score = json_data.get("totalScore")
+        if has_total_score and total_score:
+            subject_score = SubjectScore(
+                score=total_score["userScore"],
+                subject=Subject(
+                    id="",
+                    name=total_score["subjectName"],
+                    code="99",
+                    standard_score=total_score["standardScore"],
+                    exam_id=exam.id,
+                ),
+                person=StuPerson(),
+                class_rank=exam.class_rank,
+                grade_rank=exam.grade_rank,
+            )
+            mark.append(subject_score)
+        self._set_exam_rank(mark)
         return mark
 
-    def get_self_mark(self,
-                      exam_data: Union[Exam, str] = "",
-                      has_total_score: bool = True) -> Mark:
+    def get_self_mark(
+        self, exam_data: Union[Exam, str] = "", has_total_score: bool = True
+    ) -> Mark:
         """获取指定考试的成绩
 
         Args:
             exam_data (Union[Exam, str]): 考试id 或 考试名称 或 Exam实例, 默认值为最新考试
             has_total_score (bool): 是否计算总分, 默认为True
 
         Returns:
@@ -285,32 +271,32 @@
         if exam is None:
             return Mark()
         return self.__get_self_mark(exam, has_total_score)
 
     def __get_subjects(self, exam: Exam) -> ExtendedList[Subject]:
         self.update_login_status()
         subjects: ExtendedList[Subject] = ExtendedList()
-        r = self._session.get(Url.GET_SUBJECT_URL,
-                              params={"examId": exam.id},
-                              headers=self._get_auth_header())
+        r = self._session.get(
+            Url.GET_SUBJECT_URL,
+            params={"examId": exam.id},
+            headers=self._get_auth_header(),
+        )
         if not r.ok:
-            raise PageConnectionError(
-                f"__get_subjects中出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()
-            for subject in json_data["result"]["paperList"]:
-                subjects.append(
-                    Subject(id=subject["paperId"],
-                            name=subject["subjectName"],
-                            code=subject["subjectCode"],
-                            standard_score=subject["standardScore"],
-                            exam_id=exam.id))
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"__get_subjects中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
+            raise PageConnectionError(f"__get_subjects中出错, 状态码为{r.status_code}")
+        json_data = r.json()
+        for subject in json_data["result"]["paperList"]:
+            subjects.append(
+                Subject(
+                    id=subject["paperId"],
+                    name=subject["subjectName"],
+                    code=subject["subjectCode"],
+                    standard_score=subject["standardScore"],
+                    exam_id=exam.id,
+                )
+            )
         return subjects
 
     def get_subjects(self, exam_data: Union[Exam, str] = "") -> ExtendedList[Subject]:
         """获得指定考试的所有学科(不算总分)
 
         Args:
             exam_data (Union[Exam, str]): 考试id 或 考试名称 或 Exam实例, 默认值为最新考试
@@ -328,17 +314,17 @@
         subjects = self.get_subjects(exam)
         if _check_is_uuid(subject_data):  # 判断为id还是名称
             subject = subjects.find_by_id(subject_data)  # 为id
         else:
             subject = subjects.find_by_name(subject_data)  # 为名称
         return subject
 
-    def get_subject(self,
-                    subject_data: Union[Subject, str],
-                    exam_data: Union[Exam, str] = "") -> Subject:
+    def get_subject(
+        self, subject_data: Union[Subject, str], exam_data: Union[Exam, str] = ""
+    ) -> Subject:
         """获取指定考试的学科
 
         Args:
             subject_data (Union[Subject, str]): 学科id 或 学科名称, 为Subject实例时直接返回
             exam_data (Union[Exam, str]): 考试id 或 考试名称 或 Exam实例, 默认值为最新考试
 
         Returns:
@@ -350,38 +336,35 @@
         if exam is None:
             return Subject()
         subject = self.__get_subject(exam, subject_data)
         return subject if subject is not None else Subject()
 
     def __get_original(self, subject_id: str, exam_id: str) -> List[str]:
         self.update_login_status()
-        r = self._session.get(Url.GET_ORIGINAL_URL,
-                              params={
-                                  "examId": exam_id,
-                                  "paperId": subject_id,
-                              },
-                              headers=self._get_auth_header())
+        r = self._session.get(
+            Url.GET_ORIGINAL_URL,
+            params={
+                "examId": exam_id,
+                "paperId": subject_id,
+            },
+            headers=self._get_auth_header(),
+        )
         if not r.ok:
-            raise PageConnectionError(
-                f"__get_original中出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()
-            if json_data["result"] == "":
-                raise GetOriginalError(json_data["errorCode"], json_data["errorInfo"])
-            image_urls = []
-            for image_url in json.loads(json_data["result"]["sheetImages"]):
-                image_urls.append(image_url)
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"__get_original中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
+            raise PageConnectionError(f"__get_original中出错, 状态码为{r.status_code}")
+        json_data = r.json()
+        if json_data["result"] == "":
+            print(json_data)
+        image_urls = []
+        for image_url in json.loads(json_data["result"]["sheetImages"]):
+            image_urls.append(image_url)
         return image_urls
 
-    def get_original(self,
-                     subject_data: Union[Subject, str],
-                     exam_data: Union[Exam, str] = "") -> List[str]:
+    def get_original(
+        self, subject_data: Union[Subject, str], exam_data: Union[Exam, str] = ""
+    ) -> List[str]:
         """获得指定考试学科的原卷地址
 
         Args:
             subject_data (Union[Subject, str]): 学科id 或 学科名称 或 Subject实例
             exam_data (Union[Exam, str]): 考试id 或 考试名称, 默认为最新考试
 
         Returns:
@@ -394,29 +377,27 @@
         if not subject:
             return []
         return self.__get_original(subject.id, exam.id)
 
     def get_clazzs(self) -> ExtendedList[StuClass]:
         """获取当前年级所有班级"""
         clazzs: ExtendedList[StuClass] = ExtendedList()
-        r = self._session.get(Url.GET_CLAZZS_URL,
-                              params={"d": int(time.time())})
+        r = self._session.get(Url.GET_CLAZZS_URL, params={"d": int(time.time())})
         if not r.ok:
             raise PageConnectionError(f"get_clazzs中出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()
-            for clazz in json_data["clazzs"]:
-                clazzs.append(
-                    StuClass(name=clazz["name"],
-                             id=clazz["id"],
-                             grade=self.clazz.grade,
-                             school=self.clazz.school))
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"get_clazzs中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
+        json_data = r.json()
+        for clazz in json_data["clazzs"]:
+            clazzs.append(
+                StuClass(
+                    name=clazz["name"],
+                    id=clazz["id"],
+                    grade=self.clazz.grade,
+                    school=self.clazz.school,
+                )
+            )
         return clazzs
 
     def get_clazz(self, clazz_data: Union[StuClass, str] = "") -> StuClass:
         """获取当前年级班级
 
         Args:
             clazz_data (Union[StuClass, str]): 班级id 或 班级名称, 为StuClass实例时直接返回, 为空时返回自己班级
@@ -433,260 +414,202 @@
             clazz = clazzs.find_by_id(clazz_data)  # 为id
         else:
             clazz = clazzs.find_by_name(clazz_data)  # 为名称
         return clazz
 
     def __get_classmates(self, clazz_id: str) -> ExtendedList[StuPerson]:
         self.update_login_status()
-        classmates = StuPersonList()
-        r = self._session.get(Url.GET_CLASSMATES_URL,
-                              params={
-                                  "r": f"{self.id}student",
-                                  "clazzId": clazz_id
-                              })
+        classmates = ExtendedList()
+        r = self._session.get(
+            Url.GET_CLASSMATES_URL,
+            params={"r": f"{self.id}student", "clazzId": clazz_id},
+        )
         if not r.ok:
-            raise PageConnectionError(
-                f"__get_classmates中出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()
-            for classmate_data in json_data:
-                birthday = int(int(classmate_data.get("birthday", 0)) / 1000)
-                classmate = StuPerson(
-                    name=classmate_data["name"],
-                    id=classmate_data["id"],
-                    clazz=StuClass(
-                        id=classmate_data["clazz"]["id"],
-                        name=classmate_data["clazz"]["name"],
-                        grade=self.clazz.grade,
-                        school=School(
-                            id=classmate_data["clazz"]["school"]["id"],
-                            name=classmate_data["clazz"]["school"]["name"])),
-                    code=classmate_data.get("code"),
-                    email=classmate_data["email"],
-                    qq_number=classmate_data["im"],
-                    gender=Sex.BOY if classmate_data["gender"] == "1" else Sex.GIRL,
-                    mobile=classmate_data["mobile"])
-                classmate.birthday = birthday
-                classmates.append(classmate)
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"__get_classmates中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
+            raise PageConnectionError(f"__get_classmates中出错, 状态码为{r.status_code}")
+        json_data = r.json()
+        for classmate_data in json_data:
+            classmate = StuPerson(
+                name=classmate_data["name"],
+                id=classmate_data["id"],
+                clazz=StuClass(
+                    id=classmate_data["clazz"]["id"],
+                    name=classmate_data["clazz"]["name"],
+                    grade=self.clazz.grade,
+                    school=School(
+                        id=classmate_data["clazz"]["school"]["id"],
+                        name=classmate_data["clazz"]["school"]["name"],
+                    ),
+                ),
+                code=classmate_data.get("code"),
+                email=classmate_data["email"],
+                gender=Sex.BOY if classmate_data["gender"] == "1" else Sex.GIRL,
+                mobile=classmate_data["mobile"],
+            )
+            classmates.append(classmate)
         return classmates
 
-    def get_classmates(self, clazz_data: Union[StuClass, str] = "") -> ExtendedList[StuPerson]:
+    def get_classmates(
+        self, clazz_data: Union[StuClass, str] = ""
+    ) -> ExtendedList[StuPerson]:
         """获取指定班级里学生列表
 
         Args:
             clazz_data (Union[StuClass, str]): 班级id 或 班级名称 或 StuClass实例, 为空时获取本班学生列表
 
         Returns:
             ExtendedList[StuPerson]
         """
         clazz = self.get_clazz(clazz_data)
         if clazz is None:
             return ExtendedList([])
         return self.__get_classmates(clazz.id)
 
-    def get_friends(self) -> ExtendedList[StuPerson]:
-        """获取朋友列表"""
-        self.update_login_status()
-        friends = StuPersonList()
-        r = self._session.get(Url.GET_FRIEND_URL,
-                              params={"d": int(time.time())})
-        if not r.ok:
-            raise PageConnectionError(f"get_friends中出错, 状态码为{r.status_code}")
-        try:
-            json_data = r.json()
-            for friend in json_data["friendList"]:
-                friends.append(
-                    StuPerson(name=friend["friendName"], id=friend["friendId"]))
-        except (JSONDecodeError, KeyError) as e:
-            raise PageInformationError(
-                f"get_friends中网页内容发生改变, 错误为{e}, 内容为\n{r.text}")
-        return friends
-
-    def invite_friend(self, friend: Union[StuPerson, str]) -> FriendMsg:
-        """邀请朋友
-
-        Args:
-            friend (Union[StuPerson, str]): 用户id 或 StuPerson的实例
-
-        Returns:
-            FriendMsg
-        """
-        self.update_login_status()
-        user_id = friend
-        if isinstance(friend, StuPerson):
-            user_id = friend.id
-        r = self._session.get(Url.INVITE_FRIEND_URL,
-                              params={
-                                  "d": int(time.time()),
-                                  "friendId": user_id,
-                                  "isTwoWay": "true"
-                              })
-        if not r.ok:
-            raise PageConnectionError(f"invite_friend中出错, 状态码为{r.status_code}")
-        json_data = r.json()
-        if json_data["result"] == "success":
-            return FriendMsg.SUCCESS
-        elif json_data["message"] == "已发送过邀请，等待对方答复":
-            return FriendMsg.ALREADY
-        else:
-            return FriendMsg.UNDEFINED
-
-    def remove_friend(self, friend: Union[StuPerson, str]) -> bool:
-        """删除朋友
-
-        Args:
-            friend (Union[StuPerson, str]): 用户id 或 StuPerson的实例
-
-        Returns:
-            bool: True 表示删除成功, False 表示删除失败
-        """
-        self.update_login_status()
-        user_id = friend
-        if isinstance(friend, StuPerson):
-            user_id = friend.id
-        r = self._session.get(Url.DELETE_FRIEND_URL,
-                              params={
-                                  "d": int(time.time()),
-                                  "friendId": user_id
-                              })
-        if not r.ok:
-            raise PageConnectionError(f"remove_friend中出错, 状态码为{r.status_code}")
-        return r.json()["result"] == "success"
-    
-    def get_homeworks(self, size: int = 20, is_complete: bool = False, subject_code: str = "-1", createTime: int = 0)  -> ExtendedList[StuHomework]:
+    def get_homeworks(
+        self,
+        size: int = 20,
+        is_complete: bool = False,
+        subject_code: str = "-1",
+        createTime: int = 0,
+    ) -> ExtendedList[StuHomework]:
         """获取指定数量的作业(暂时不支持获取所有作业)
 
         Args:
             size (int): 返回的数量
             is_complete (bool): True 表示取已完成的作业, False 表示取未完成的作业
             subject_code (code): "01" 表示取语文作业, "02"表示取数学作业, 以此类推
             createTime (int): 取创建时间在多久以前的作业, 0表示从最新取 (暂时用不到)
         Returns:
             ExtendedList[StuHomework]: 作业(不包含作业资源)
         """
         self.update_login_status()
-        r = self._session.get(Url.GET_HOMEWORK_URL, params={
-            "pageIndex": 2,
-            "completeStatus": 1 if is_complete else 0,
-            "pageSize": size, # 取几个
-            "subjectCode": subject_code,
-            "token": self._get_auth_header()["XToken"],
-            "createTime": createTime # 创建时间在多久以前的 0 为从最新开始
-        })
+        r = self._session.get(
+            Url.GET_HOMEWORK_URL,
+            params={
+                "pageIndex": 2,
+                "completeStatus": 1 if is_complete else 0,
+                "pageSize": size,  # 取几个
+                "subjectCode": subject_code,
+                "token": self._get_auth_header()["XToken"],
+                "createTime": createTime,  # 创建时间在多久以前的 0 为从最新开始
+            },
+        )
         homeworks: ExtendedList[StuHomework] = ExtendedList()
         data = r.json()["result"]
         for each in data["list"]:
-            homeworks.append(StuHomework(
-                id=each["hwId"],
-                title=each["hwTitle"],
-                type=HwType(
-                    name=each["homeWorkTypeDTO"]["typeName"],
-                    code=each["homeWorkTypeDTO"]["typeCode"],
-                ),
-                begin_time=each["beginTime"] / 1000,
-                end_time=each["endTime"] / 1000,
-                create_time=each["createTime"] / 1000,
-                subject=BasicSubject(
-                    name=each["subjectName"],
-                    code=each["subjectCode"]
-                ),
-                is_allow_makeup=bool(each["isAllowMakeup"]),
-                class_id=each["classId"],
-                ansPubData=HwAnsPubData(
-                    name=each["openAnswerDTO"]["answerPubName"],
-                    code=each["openAnswerDTO"]["answerPubType"]
-                ),
-                stu_hwid=each["stuHwId"]
-            ))
+            homeworks.append(
+                StuHomework(
+                    id=each["hwId"],
+                    title=each["hwTitle"],
+                    type=HwType(
+                        name=each["homeWorkTypeDTO"]["typeName"],
+                        code=each["homeWorkTypeDTO"]["typeCode"],
+                    ),
+                    begin_time=each["beginTime"] / 1000,
+                    end_time=each["endTime"] / 1000,
+                    create_time=each["createTime"] / 1000,
+                    subject=BasicSubject(
+                        name=each["subjectName"], code=each["subjectCode"]
+                    ),
+                    is_allow_makeup=bool(each["isAllowMakeup"]),
+                    class_id=each["classId"],
+                    stu_hwid=each["stuHwId"],
+                )
+            )
         return homeworks
-    
-    def get_homework_resources(self, hwid: str, hw_typecode: int) -> List[HwResource]:
+
+    def get_homework_resources(self, homework: StuHomework) -> List[HwResource]:
         """获取指定作业的作业资源(例如题目文档)
 
         Args:
-            hwid (str): 作业id
-            hw_typecode (int): 作业类型代码
+            homework (HwResource): 作业
         Returns:
             List[HwResource]: 作业资源
         """
         self.update_login_status()
-        if hw_typecode == 102:
+        if homework.type.code == 102:
             return []
-        r = self._session.post(Url.GET_HOMEWORK_RESOURCE_URL, json={
-            "base":{
-                "appId": "WNLOIVE",
-                "appVersion": "",
-                "sysVersion": "v1001",
-                "sysType": "web",
-                "packageName": "com.iflytek.edu.hw",
-                "udid": self.id,
-                "expand": {}
+        r = self._session.post(
+            Url.GET_HOMEWORK_RESOURCE_URL,
+            json={
+                "base": {
+                    "appId": "WNLOIVE",
+                    "appVersion": "",
+                    "sysVersion": "v1001",
+                    "sysType": "web",
+                    "packageName": "com.iflytek.edu.hw",
+                    "udid": self.id,
+                    "expand": {},
+                },
+                "params": {"hwId": homework.id},
+            },
+            headers={
+                "Authorization": self._get_auth_header()["XToken"],
             },
-            "params": {"hwId":hwid}
-        }, headers={
-            "Authorization": self._get_auth_header()["XToken"],
-        })
+        )
         data = r.json()["result"]
         resources = []
         for each in data["topicAttachments"]:
-            resources.append(HwResource(
-                name=each["name"],
-                path=each["path"]
-            ))
+            resources.append(HwResource(name=each["name"], path=each["path"]))
         return resources
 
     def _set_exam_rank(self, mark: Mark):
-        r = self._session.get(Url.GET_EXAM_LEVEL_TREND_URL, params={
-            "examId": mark.exam.id,
-            "pageIndex": 1,
-            "pageSize": 1
-        }, headers=self._get_auth_header())
+        r = self._session.get(
+            Url.GET_EXAM_LEVEL_TREND_URL,
+            params={"examId": mark.exam.id, "pageIndex": 1, "pageSize": 1},
+            headers=self._get_auth_header(),
+        )
         data = r.json()
         if data["errorCode"] != 0:
             return
-        num = data["result"]["list"][0]["dataList"][0]["statTotalNum"]
-
-        r = self._session.get(Url.GET_SUBJECT_DIAGNOSIS, params={
-            "examId": mark.exam.id
-        }, headers=self._get_auth_header())
+        num = data["result"]["list"][0]["dataList"][0]["totalNum"]
+        r = self._session.get(
+            Url.GET_SUBJECT_DIAGNOSIS,
+            params={"examId": mark.exam.id},
+            headers=self._get_auth_header(),
+        )
         data = r.json()
         if data["errorCode"] != 0:
             return
         for each in data["result"]["list"]:
             each_mark = mark.find(lambda t: t.subject.code == each["subjectCode"])
             if each_mark is not None:
-                each_mark.class_rank = math.ceil(each["myRank"] / 100 * num)
-    
+                if each["myRank"] == 0:
+                    each_mark.class_rank = 1
+                else:
+                    each_mark.class_rank = math.ceil(each["myRank"] / 100 * num)
+
     def get_errorbook(self, exam_id, subject_id: str) -> List[ErrorBookTopic]:
-        r = self._session.get(Url.GET_ERRORBOOK_URL, params={
-            "examId": exam_id,
-            "paperId": subject_id
-        }, headers=self._get_auth_header())
+        r = self._session.get(
+            Url.GET_ERRORBOOK_URL,
+            params={"examId": exam_id, "paperId": subject_id},
+            headers=self._get_auth_header(),
+        )
         data = r.json()
-        if data["errorCode"] != 0: #  {'errorCode': 40217, 'errorInfo': '暂时未收集到试题信息,无法查看', 'result': ''}
+        if (
+            data["errorCode"] != 0
+        ):  #  {'errorCode': 40217, 'errorInfo': '暂时未收集到试题信息,无法查看', 'result': ''}
             raise Exception(data)
         result = []
         for each in data["result"]["wrongTopicAnalysis"]["topicList"]:
-            result.append(ErrorBookTopic(
-                analysis_html=each["analysisHtml"],
-                answer_html=each["answerHtml"],
-                answer_type=each["answerType"],
-                is_correct=each["beCorrect"],
-                class_score_rate=each["classScoreRate"],
-                content_html=each["contentHtml"],
-                difficulty=each["difficultyValue"],
-                dis_title_number=each["disTitleNumber"],
-                image_answer=each.get("imageAnswer"),
-                paper_id=each["paperId"],
-                subject_name=each["paperName"],
-                score=each["score"],
-                standard_answer=each["standardAnswer"],
-                standard_score=each["standardScore"],
-                topic_analysis_img_url=each["topicAnalysisImgUrl"],
-                subject_id=each["topicId"],
-                topic_img_url=each["topicImgUrl"],
-                topic_source_paper_name=each["topicSourcePaperName"]
-            ))
-        return result
+            result.append(
+                ErrorBookTopic(
+                    analysis_html=each["analysisHtml"],
+                    answer_html=each["answerHtml"],
+                    answer_type=each["answerType"],
+                    is_correct=each["beCorrect"],
+                    class_score_rate=each["classScoreRate"],
+                    content_html=each["contentHtml"],
+                    difficulty=each["difficultyValue"],
+                    dis_title_number=each["disTitleNumber"],
+                    image_answer=each.get("imageAnswer"),
+                    paper_id=each["paperId"],
+                    subject_name=each["paperName"],
+                    score=each["score"],
+                    standard_answer=each["standardAnswer"],
+                    standard_score=each["standardScore"],
+                    topic_analysis_img_url=each["topicAnalysisImgUrl"],
+                    subject_id=each["topicId"],
+                    topic_img_url=each["topicImgUrl"],
+                    topic_source_paper_name=each["topicSourcePaperName"],
+                )
+            )
+        return result
```

## zhixuewang/student/urls.py

```diff
@@ -19,18 +19,15 @@
     GET_RECENT_EXAM_URL = f"{BASE_URL}/zhixuebao/report/exam/getRecentExam"
     # GET_MARK_URL = f"{BASE_URL}/zhixuebao/zhixuebao/feesReport/getStuSingleReportDataForPK/"
     GET_SUBJECT_URL = f"{BASE_URL}/zhixuebao/report/exam/getReportMain"
     GET_MARK_URL = GET_SUBJECT_URL
     GET_ORIGINAL_URL = f"{BASE_URL}/zhixuebao/report/checksheet/"
 
     # Person
-    GET_FRIEND_URL = f"{BASE_URL}/zhixuebao/zhixuebao/friendmanage/"
-    INVITE_FRIEND_URL = f"{BASE_URL}/zhixuebao/zhixuebao/addFriend/"
-    DELETE_FRIEND_URL = f"{BASE_URL}/zhixuebao/zhixuebao/delFriend/"
-    GET_CLAZZS_URL = GET_FRIEND_URL
+    GET_CLAZZS_URL = f"{BASE_URL}/zhixuebao/zhixuebao/friendmanage/"
     # GET_CLASSMATES_URL = f"{BASE_URL}/zhixuebao/zhixuebao/getClassStudent/"
     GET_CLASSMATES_URL = f"{BASE_URL}/container/contact/student/students"
     GET_TEACHERS_URL = f"{BASE_URL}/container/contact/student/teachers"
 
     APP_BASE_URL = "https://mhw.zhixue.com"
     # Homework
     GET_HOMEWORK_URL = f"{APP_BASE_URL}/homework_middle_service/stuapp/getStudentHomeWorkList"
```

## zhixuewang/teacher/models.py

```diff
@@ -1,243 +1,41 @@
-from dataclasses import field, dataclass
+from dataclasses import dataclass
 from enum import Enum
-from typing import Dict, List, Union
-import copy
-from zhixuewang.models import BasicSubject, Exam, ExtendedList, Person, School, StuClass, Sex, StuPerson, Subject, SubjectScore
-from zhixuewang.tools.rank import get_rank_map
+from zhixuewang.models import (
+    Person,
+    School,
+    StuClass,
+    Sex,
+)
 
 
 class TeacherRole(Enum):
     TEACHER = "老师"
     HEADMASTER = "校长"
     GRADE_DIRECTER = "年级组长"
 
     def __str__(self):
         return self._value_
 
 
 class TeaPerson(Person):
-    def __init__(self,
-                 name: str = "",
-                 id: str = "",
-                 gender: Sex = Sex.GIRL,
-                 email: str = "",
-                 mobile: str = "",
-                 qq_number: str = "",
-                 birthday: int = 0,
-                 avatar: str = "",
-                 code: str = "",
-                 clazz: StuClass = None,
-                 roles: List[TeacherRole] = [TeacherRole.TEACHER]):
-        super().__init__(name, id, gender, email, mobile, qq_number, birthday,
-                         avatar)
+    def __init__(
+        self,
+        name: str = "",
+        id: str = "",
+        gender: Sex = Sex.GIRL,
+        mobile: str = "",
+        avatar: str = "",
+        code: str = "",
+        clazz: StuClass = None,
+    ):
+        super().__init__(name, id, gender, mobile, avatar)
         self.code = code
         self.clazz = clazz
 
 
-# class TeaPersonList(ExtendedList):
-#     def find_by_code(self, code: str) -> StuPerson:
-#         return self.find(lambda p: p.code == code)
-
-#     def find_by_clazz_id(self, clazz_id: str) -> StuPerson:
-#         return self.find(lambda p: p.clazz.id == clazz_id)
-
-#     def find_by_clazz(self, clazz: StuClass) -> StuPerson:
-#         return self.find(lambda p: p.clazz == clazz)
-
-#     def find_by_school_id(self, school_id: str) -> StuPerson:
-#         return self.find(lambda p: p.school.id == school_id)
-
-#     def find_by_school(self, school: School) -> StuPerson:
-#         return self.find(lambda p: p.school == school)
-
-class PersonScores(ExtendedList[SubjectScore]):
-    """某人分数"""
-    def __init__(self, l: List[SubjectScore]):
-        super().__init__(l)
-    
-    def resolve(self) -> None:
-        self.subject_map = {each.subject.name: i for i, each in enumerate(self)}
-
-    def get_score(self, subject_name: str) -> SubjectScore:
-        """获取分数
-        Args:
-            subject_name (str): 科目名称
-
-        Returns:
-            SubjectScore
-        """
-        return self[self.subject_map[subject_name]]
-
-    
-
-class ClassSubjectScores(ExtendedList[SubjectScore]):
-    """班级单科分数"""
-    def __init__(self, l: List[SubjectScore]):
-        l = sorted(l, key=lambda t: t.score, reverse=True)
-        rank_map = get_rank_map([i.score for i in l])
-        for each in l:
-            each.class_rank = rank_map[each.score]
-        super().__init__(l)
-
-    def get_person_score(self, name: str) -> Union[SubjectScore, None]:
-        return self.find(lambda t: t.person.name == name)
-    
-    @property
-    def avg_score(self) -> float:
-        total_score = 0
-        for each in self:
-            total_score += each.score
-        return total_score / len(self)
-    
-    @property
-    def max_score(self) -> float:
-        return self[0].score
-    
-    @property
-    def min_score(self) -> float:
-        return self[-1].score
-
-# class ClassScores(List[ExtendedList[SubjectScore]]):
-#     """班级某场考试分数"""
-#     def __init__(self, l: List[ExtendedList[SubjectScore]]):
-#         l = sorted(l, key=lambda t: t[0].subject.code, reverse=False)
-#         self.subject_map = {each[0].subject.name: i for i, each in enumerate(l)}
-#         temp_person_map: Dict[str, PersonScores] = {}
-#         self.id_name_map: Dict[str, List[str]] = {}
-#         for each_subject in l:
-#             for each in each_subject:
-#                 temp_person_map[each.person.id] = PersonScores([each])
-#                 if self.subject_map[each.subject.name] == 0:
-#                     if each.person.id not in self.id_name_map:
-#                         self.id_name_map[each.person.id] = [each.person.name] 
-#                     else:
-#                         self.id_name_map[each.person.id].append(each.person.name)
-        
-#         super().__init__(l)
-    
-#     def get_subject_scores(self, subject_name: str) -> ExtendedList[SubjectScore]:
-#         """获取某一科的分数"""
-#         return self[self.subject_map[subject_name]]
-    
-#     def get_person_scores(self, person_name: str) -> PersonScores:
-#         """获取某人分数"""
-#         result = []
-#         for each_person_id in self.id_name_map[person_name]:
-#             result.extend(self.person_map[each_person_id])
-#         return PersonScores(result)
-    
-#     def to_person_scores(self) -> ExtendedList[PersonScores]:
-#         return ExtendedList(list(self.person_map.values()))
-
-    
-class Scores(ExtendedList[PersonScores]):
-    def __init__(self, l: List[ExtendedList[SubjectScore]]):
-        self.person_map: Dict[str, PersonScores] = {}
-        self.name_id_map: Dict[str, List[str]] = {}
-        for each_subject in l:
-            for each in each_subject:
-                if each.person.id not in self.person_map: # 可能有人没考第一科
-                    self.person_map[each.person.id] = PersonScores([])
-                self.person_map[each.person.id].append(each)
-                if each.person.name not in self.name_id_map:
-                    self.name_id_map[each.person.name] = [each.person.id] 
-                elif each.person.id not in self.name_id_map[each.person.name]:
-                    self.name_id_map[each.person.name].append(each.person.id)
-        for each in self.person_map.values():
-            each.resolve()
-        result = ExtendedList(list(self.person_map.values()))
-        super().__init__(sorted(result, key=lambda t: t[-1].score, reverse=True))
-
-    def get_person_scores_by_id(self, id: str) -> "PersonScores":
-        return self.person_map[id]
-
-    def get_person_scores_by_name(self, name: str) -> List[PersonScores]:
-        result = []
-        for each_id in self.name_id_map[name]:
-            result.append(self.person_map[each_id])
-        return result
-
-    def get_school_scores_by_name(self, school_name: str) -> "Scores":
-        return Scores(list(filter(lambda t: t[0].person.clazz.school.name == school_name, self)))
-
-    def get_school_scores_by_id(self, school_id: str) -> "Scores":
-        return Scores(list(filter(lambda t: t[0].person.clazz.school.id == school_id, self)))
-
-    def get_class_scores_by_name(self, class_name: str):
-        return Scores(list(filter(lambda t: t[0].person.clazz.name == class_name, self)))
-
-    def get_class_scores_by_id(self, class_id: str):
-        return Scores(list(filter(lambda t: t[0].person.clazz.name == class_id, self)))
-
-
-# 单科 班级分类
-@dataclass()
-class RankData:
-    schoolRankMap: Dict[str, Dict[float, int]]
-    # schoolId => classID => score => rank
-    schoolsRankMap: Dict[str, Dict[str, Dict[float, int]]]
-    # 总排名
-    allRankMap: Dict[float, int]
-
-
 @dataclass
-class TopicTeacherMarkingProgress:
-    teacher_name: str
-    school: School
-    is_online: bool
-    teacher_code: str
+class MarkingProgress:
+    topic_number: str
+    complete_rate: float
     complete_count: int
-    uncomplete_count: int
-    
-    @property
-    def complete_precent(self) -> float:
-        if self.complete_count == 0 and self.uncomplete_count == 0:
-            return 100
-        return (self.complete_count / (self.complete_count + self.uncomplete_count)) * 100
-
-@dataclass
-class TopicMarkingProgress:
-    disp_title: str
-    topic_number: int
-    complete_precent: float 
-    subject_id: str
-    teachers: List[TopicTeacherMarkingProgress] = field(default_factory=list)
-
-@dataclass
-class SubjectMarkingProgress:
-    subject: Subject
-    markingProgresses: List[TopicMarkingProgress] = field(default_factory=list)
-
-@dataclass
-class ExamMarkingProgress:
-    exam: Exam
-    markingProgresses: List[SubjectMarkingProgress] = field(default_factory=list)
-
-@dataclass
-class ExtraData:
-    avg_score: float
-    medium_score: float # 中位数
-    pass_rate: float # 及格率
-    excellent_rate: float # 优秀率(85%以上)
-    perfect_rate: float # 满分率
-    var: float # 方差
-
-@dataclass
-class ClassExtraData(ExtraData):
-    class_id: str
-    class_name: str
-
-@dataclass
-class SchoolExtraData(ExtraData):
-    school_id: str
-    school_name: str
-
-@dataclass
-class ExamSubjectExtraData:
-    subject: Subject
-    class_extra_data: ExtendedList[ClassExtraData]
-    school_extra_data: ExtendedList[SchoolExtraData]
-    exam_extra_data: ExtraData
-
-class ExamExtraData(List[ExamSubjectExtraData]):
-    pass
+    all_count: int
```

## zhixuewang/teacher/teacher.py

```diff
@@ -1,374 +1,174 @@
 import asyncio
-import json
-import math
-from typing import Dict, List
+from typing import List
 
 import httpx
-from zhixuewang.models import (Account, Exam, ExtendedList, Role,
-                               School, Sex, StuClass, StuPerson, Subject,
-                               SubjectScore)
-from zhixuewang.teacher.models import (ClassExtraData,
-                                       ExamExtraData, ExamMarkingProgress,
-                                       ExamSubjectExtraData,
-                                       RankData, SchoolExtraData, Scores,
-                                       SubjectMarkingProgress, TeaPerson,
-                                       TopicMarkingProgress,
-                                       TopicTeacherMarkingProgress)
-from zhixuewang.teacher.tools import (
-    calc_total_score, divide_array, get_extra_data, group_by, set_rank, spread_array)
+from zhixuewang.models import (
+    Account,
+    Exam,
+    ExtendedList,
+    Role,
+    School,
+    StuClass,
+    Subject,
+)
+from zhixuewang.teacher.models import (
+    MarkingProgress,
+    TeaPerson,
+)
 from zhixuewang.teacher.urls import Url
-from zhixuewang.tools.rank import get_rank_map
 
 
 class TeacherAccount(Account, TeaPerson):
     """老师账号"""
 
     def __init__(self, session):
         super().__init__(session, Role.teacher)
         self._token = None
 
     def set_base_info(self):
         r = self._session.get(
             Url.TEST_URL,
             headers={
-                "referer":
-                "https://www.zhixue.com/container/container/teacher/index/"
-            })
+                "referer": "https://www.zhixue.com/container/container/teacher/index/"
+            },
+        )
         json_data = r.json()["teacher"]
-        self.email = json_data.get("email")
-        self.gender = Sex.BOY if json_data["gender"] == "1" else Sex.GIRL
         self.id = json_data.get("id")
         self.mobile = json_data.get("mobile")
         self.name = json_data.get("name")
         self.roles = json_data["roles"]
         return self
 
-    async def __get_school_exam_classes(self, school_id: str, subject_id: str) -> List[StuClass]:
+    async def __get_school_exam_classes(
+        self, school_id: str, subject_id: str
+    ) -> List[StuClass]:
         async with httpx.AsyncClient(cookies=self._session.cookies) as client:
-            r = await client.get(Url.GET_EXAM_SCHOOLS_URL, params={
-                "schoolId": school_id,
-                "markingPaperId": subject_id
-            })
+            r = await client.get(
+                Url.GET_EXAM_SCHOOLS_URL,
+                params={"schoolId": school_id, "markingPaperId": subject_id},
+            )
             data = r.json()
             if data is None:
                 return []
             classes = []
 
             for each in data:
-                classes.append(StuClass(
-                    id=each["classId"],
-                    name=each["className"],
-                    school=School(id=each["schoolId"])
-                ))
+                classes.append(
+                    StuClass(
+                        id=each["classId"],
+                        name=each["className"],
+                        school=School(id=each["schoolId"]),
+                    )
+                )
             return classes
 
-    def get_school_exam_classes(self, school_id: str, subject_id: str) -> List[StuClass]:
+    def get_school_exam_classes(
+        self, school_id: str, subject_id: str
+    ) -> List[StuClass]:
         self.update_login_status()
         return asyncio.run(self.__get_school_exam_classes(school_id, subject_id))
 
-    def get_original_paper(self,
-                           userId: str, paperId: str,
-                           saveToPath: str) -> bool:
+    def get_original_paper(self, userId: str, paperId: str, saveToPath: str) -> bool:
         """
         获得原卷
         Args:
             userId (str): 为需要查询原卷的userId
             paperId (str): 为需要查询的学科ID(topicSetId)
             saveToPath (str): 为原卷保存位置(html文件), 精确到文件名
         Return:
             bool: 正常会返回True
         """
-        data = self._session.get(Url.ORIGINAL_PAPER_URL, params={
-            "userId": userId,
-            "paperId": paperId
-        })
+        data = self._session.get(
+            Url.ORIGINAL_PAPER_URL, params={"userId": userId, "paperId": paperId}
+        )
         with open(saveToPath, encoding="utf-8", mode="w+") as fhandle:
-            # 替换html内容，让文件可以正常显示
-            fhandle.writelines(data.text.replace(
-                "//static.zhixue.com", "https://static.zhixue.com"))
+            fhandle.writelines(
+                data.text.replace("//static.zhixue.com", "https://static.zhixue.com")
+            )
         return True
 
     def get_exam_subjects(self, exam_id: str) -> ExtendedList[Subject]:
+        """
+        获取某个考试的考试科目
+        Args:
+            exam_id (str): 为需要查询考试的id
+        Return:
+            bool: 正常会返回True
+        """
         self.update_login_status()
-        r = self._session.get(Url.GET_EXAM_SUBJECTS_URL, params={
-            "examId": exam_id
-        })
+        r = self._session.get(Url.GET_EXAM_SUBJECTS_URL, params={"examId": exam_id})
         data = r.json()["result"]
         subjects = []
         for each in data:
             name = each["subjectName"]
             if name != "总分" and (not each.get("isSubjectGroup")):  # 排除学科组()
-                subjects.append(Subject(
-                    id=each["topicSetId"],
-                    name=each["subjectName"],
-                    code=each["subjectCode"],
-                    standard_score=each["standScore"]
-                ))
+                subjects.append(
+                    Subject(
+                        id=each["topicSetId"],
+                        name=each["subjectName"],
+                        code=each["subjectCode"],
+                        standard_score=each["standScore"],
+                    )
+                )
         return ExtendedList(sorted(subjects, key=lambda x: x.code, reverse=False))
 
     def get_exam_detail(self, exam_id: str) -> Exam:
+        """
+        获取某个考试的详细情况
+        包括参考学校和考试科目
+        Args:
+            exam_id (str): 为需要查询考试的id
+        Return:
+            Exam
+        """
         self.update_login_status()
-        r = self._session.post(Url.GET_EXAM_DETAIL_URL, data={
-            "examId": exam_id
-        })
+        r = self._session.post(Url.GET_EXAM_DETAIL_URL, data={"examId": exam_id})
         data = r.json()["result"]
         exam = Exam()
         schools: ExtendedList[School] = ExtendedList()
         for each in data["schoolList"]:
-            schools.append(School(
-                id=each["schoolId"],
-                name=each["schoolName"]
-            ))
+            schools.append(School(id=each["schoolId"], name=each["schoolName"]))
         exam.id = exam_id
         exam.name = data["exam"]["examName"]
         exam.grade_code = data["exam"]["gradeCode"]
 
-        isCrossExam = data["exam"]["isCrossExam"]
         exam.schools = schools
-        exam.status = str(isCrossExam)
+        exam.status = str(data["exam"]["isCrossExam"])
         exam.subjects = self.get_exam_subjects(exam_id)
         return exam
 
-    async def __get_class_score(self, class_id: str, subject_id: str) -> ExtendedList[SubjectScore]:
-        async with httpx.AsyncClient(cookies=self._session.cookies) as client:
-            r = await client.get(
-                Url.GET_REPORT_URL,
-                params={
-                    "type": "export_single_paper_zip",
-                    "classId": class_id,
-                    "studentNum": "",
-                    "topicSetId": subject_id,
-                    "topicNumber": "0",
-                    "startScore": "0",
-                    "endScore": "1000",
-                }, timeout=100)
-            data = r.json()
-            subjectScores: ExtendedList[SubjectScore] = ExtendedList()
-            for each in data["result"]:
-                subjectScores.append(SubjectScore(
-                    score=each["userScore"],
-                    person=StuPerson(
-                        id=each["userId"],
-                        name=each["userName"],
-                        clazz=StuClass(id=each["classId"]),
-                        code=each["userNum"]
-                    ),
-                    subject=Subject(
-                        id=subject_id,
-                        name=each["subjectName"],
-                        code=each["subjectCode"],
-                        standard_score=each["standScore"]
-                    )
-                ))
-            return subjectScores
-
-    async def __get_class_score_divide(self, classes: List[StuClass], subject_id: str) -> List[SubjectScore]:
-        count = min(math.ceil(len(classes) / 3), 50)
-        tasks = []
-        for each_classes in divide_array(classes, count):
-            each_class_ids = ",".join([i.id for i in each_classes])
-            tasks.append(self.__get_class_score(each_class_ids, subject_id))
-        data = spread_array(list(await asyncio.gather(*tasks)))
-        return data
-
-    async def __get_scores(self, exam_id: str, force_no_total_score: bool = False):
-        exam = self.get_exam_detail(exam_id)
-        tasks = []
-        for school in exam.schools:
-            tasks.append(self.__get_school_exam_classes(
-                school.id, exam.subjects[0].id))
-        result = await asyncio.gather(*tasks)
-        classes: ExtendedList[StuClass] = ExtendedList()
-        for data in result:
-            classes.extend(data)
-        class_name_map = {}
-        class_school_map = {}
-
-        for clazz in classes:
-            class_name_map[clazz.id] = clazz.name
-            class_school_map[clazz.id] = exam.schools.find_by_id(
-                clazz.school.id)
-
-        tasks = []
-        for subject in exam.subjects:
-            tasks.append(self.__get_class_score_divide(classes, subject.id))
-        scores: ExtendedList[ExtendedList[SubjectScore]] = ExtendedList(list(await asyncio.gather(*tasks)))
-        for each_subject in scores:
-            for each in each_subject:
-                each.person.clazz.name = class_name_map[each.person.clazz.id]
-                each.person.clazz.school = class_school_map[each.person.clazz.id]
-            set_rank(each_subject)
-        if (not force_no_total_score) and len(exam.subjects) > 1:
-            total_scores = calc_total_score(scores)
-            set_rank(total_scores)
-            scores.append(total_scores)
-        return scores
-
-    def get_scores(self, exam_id: str) -> Scores:
-        """获取所有分数
-
+    def get_marking_progress(
+        self,
+        subject_id: str,
+    ) -> List[MarkingProgress]:
+        """
+        获取某场考试指定科目阅卷情况
         Args:
-            exam_id (str): 考试id
-
-        Returns:
-            Scores
+            subject_id (str): 科目id
+        Return:
+            List[MarkingProgress]
         """
-        scores = asyncio.run(self.__get_scores(exam_id))
-        return Scores(scores)
-
-    def _parse_marking_progress_data(self, r, subject_id: str):
-        data = r.json()["message"]
-        progress_data = []
-        for each in json.loads(data):
-            topic_progress_data = TopicMarkingProgress(
-                disp_title=each["dispTitle"],
-                topic_number=each["topicNum"],
-                complete_precent=each["completeRate"],
-                subject_id=subject_id
+        r = self._session.post(
+            "https://pt-ali-bj-re.zhixue.com/marking/marking/markingTopicProgress/",
+            data={"markingPaperId": subject_id},
+            headers={"token": self.get_token()}
+        )
+        data = r.json()
+        result = []
+        for each in data:
+            result.append(
+                MarkingProgress(
+                    topic_number=each["topicNumber"],
+                    complete_rate=each["comleteRate"],
+                    complete_count=each["completeCount"],
+                    all_count=each["allCount"],
+                )
             )
-            for each2 in each["teacherList"]:
-                topic_progress_data.teachers.append(TopicTeacherMarkingProgress(
-                    teacher_name=each2["name"],
-                    school=School(
-                        id=each2["schoolId"],
-                        name=each2["schoolName"]
-                    ),
-                    is_online=each2["isOnline"],
-                    teacher_code=each2["code"],
-                    complete_count=each2["completeCount"],
-                    uncomplete_count=each2["arUncompleteCount"]
-                ))
-            progress_data.append(topic_progress_data)
-        return progress_data
-
-    def get_marking_progress(self, subject_id: str, school_id: str = "") -> List[TopicTeacherMarkingProgress]:
-        r = self._session.post(Url.GET_MARKING_PROGRESS_URL, data={
-            "progressParam": json.dumps({
-                "markingPaperId": subject_id,
-                "topicNum": None,
-                "subTopicIndex": None,
-                "topicStartNum": None,
-                "schoolId": school_id,
-                "topicProgress": "",
-                "teacherProgress": "",
-                "isOnline": "",
-                "teacherName": "",
-                "userId": "",
-                "examId": ""
-            })
-        })
-        # return r.json()
-        return self._parse_marking_progress_data(r, subject_id)
-
-    async def _get_marking_progress_async(self, subject_id: str, school_id: str):
-        async with httpx.AsyncClient(cookies=self._session.cookies) as client:
-            r = await client.post(Url.GET_MARKING_PROGRESS_URL, data={
-                "progressParam": json.dumps({
-                    "markingPaperId": subject_id,
-                    "topicNum": None,
-                    "subTopicIndex": None,
-                    "topicStartNum": None,
-                    "schoolId": school_id,
-                    "topicProgress": "",
-                    "teacherProgress": "",
-                    "isOnline": "",
-                    "teacherName": "",
-                    "userId": "",
-                    "examId": ""
-                })
-            })
-            return self._parse_marking_progress_data(r, subject_id)
+        return result
 
     def get_token(self) -> str:
         if self._token is not None:
             return self._token
-        r = self._session.get(
-            "https://www.zhixue.com/container/app/token/getToken")
+        r = self._session.get("https://www.zhixue.com/container/app/token/getToken")
         self._token = r.json()["result"]
         return self._token
-
-    def get_headers(self):
-        return {"token": self.get_token()}
-
-    async def _get_exam_all_marking_progress(self, exam: Exam) -> ExamMarkingProgress:
-        tasks = []
-        for subject in exam.subjects:
-            for school in exam.schools:
-                tasks.append(self._get_marking_progress_async(
-                    subject.id, school.id))
-        result = await asyncio.gather(*tasks)
-        examMarkingProgress = ExamMarkingProgress(exam)
-        for each in result:
-            examMarkingProgress.markingProgresses.append(SubjectMarkingProgress(
-                subject=exam.subjects.find_by_id(
-                    each[0].subject_id),  # type: ignore
-                markingProgresses=each
-            ))
-        return examMarkingProgress
-
-    def get_exam_all_marking_progress(self, exam_id: str) -> ExamMarkingProgress:
-        exam = self.get_exam_detail(exam_id)
-        return asyncio.run(self._get_exam_all_marking_progress(exam))
-
-    def get_exam_extra_data(self, scores: Scores) -> ExamExtraData:
-        """获取考试额外数据
-        Args:
-            scores (Scores): 分数(可由get_scores获取)
-
-        Returns:
-            ExtendedList[ExtendedList[SubjectScore]]
-        """
-        map_subject_scores: Dict[str, List[SubjectScore]] = {}
-        for score in scores:
-            for subject_score in score:
-                if subject_score.subject.id not in map_subject_scores:
-                    map_subject_scores[subject_score.subject.id] = [
-                        subject_score]
-                else:
-                    map_subject_scores[subject_score.subject.id].append(
-                        subject_score)
-        subjects_extra_data: List[ExamSubjectExtraData] = []
-        for subject_scores in map_subject_scores.values():
-            subject = subject_scores[0].subject
-            # 班级
-            class_datas = group_by(subject_scores, lambda t: t.person.clazz.id)
-            class_extra_datas = []
-            for class_data in class_datas.values():
-                extra_data = get_extra_data(class_data, subject.standard_score)
-                class_extra_datas.append(ClassExtraData(
-                    extra_data.avg_score,
-                    extra_data.medium_score,
-                    extra_data.pass_rate,
-                    extra_data.excellent_rate,
-                    extra_data.perfect_rate,
-                    extra_data.var,
-                    class_data[0].person.clazz.id,
-                    class_data[0].person.clazz.name
-                ))
-
-            # 学校
-            school_datas = group_by(
-                subject_scores, lambda t: t.person.clazz.school.id)
-            school_extra_datas = []
-            for school_data in school_datas.values():
-                extra_data = get_extra_data(
-                    school_data, subject.standard_score)
-                school_extra_datas.append(SchoolExtraData(
-                    extra_data.avg_score,
-                    extra_data.medium_score,
-                    extra_data.pass_rate,
-                    extra_data.excellent_rate,
-                    extra_data.perfect_rate,
-                    extra_data.var,
-                    school_data[0].person.clazz.school.id,
-                    school_data[0].person.clazz.school.name
-                ))
-
-            subjects_extra_data.append(ExamSubjectExtraData(
-                subject=subject,
-                class_extra_data=ExtendedList(class_extra_datas),
-                school_extra_data=ExtendedList(school_extra_datas),
-                exam_extra_data=get_extra_data(
-                    subject_scores, subject.standard_score)
-            ))
-        return ExamExtraData(subjects_extra_data)
```

## Comparing `zhixuewang-1.1.7.dist-info/LICENSE` & `zhixuewang-1.1.8.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `zhixuewang-1.1.7.dist-info/RECORD` & `zhixuewang-1.1.8.dist-info/RECORD`

 * *Files 20% similar despite different names*

```diff
@@ -1,31 +1,32 @@
-zhixuewang/__init__.py,sha256=hM1s4ao_inMeHrEV-y5BV4n00dIPb-zRW7pYO5m_ZZ8,586
+zhixuewang/__init__.py,sha256=HbuDZs83uFBOR0cm1zX1sANd9JjNWv8gEkdPEPws4n8,584
 zhixuewang/account.py,sha256=ohdDVEvIey1fRUx1oY0eKs8LKLDdgGItpKqks9DQxVA,4955
 zhixuewang/deleted.py,sha256=-ZUeSCiZRmGDivFkGij3Vt4hW5ra8syzJ0bKm62l__I,3212
-zhixuewang/exceptions.py,sha256=Uerhn4-xT4gzMdp8Kks2njgXeTqinVFWVkzl7eGQpco,1203
-zhixuewang/models.py,sha256=nGWvnXLoEh_VIlsCNhG9cFUMd1v_vuXEjmVnnpvouek,10888
-zhixuewang/session.py,sha256=b0Z8MRUhYwJSCkkLV5fo7IRHBj1Y-IC67KkDno5dITQ,4482
+zhixuewang/exceptions.py,sha256=nC84UiU3Z_TyJVKRVJMn94kX6oLVYO1mECn3wxVugR0,945
+zhixuewang/models.py,sha256=M5fOnYRMilUaaU5_zzdzAtVeyLOkxQkxJrKCu3x7aCo,8333
+zhixuewang/session.py,sha256=OrrDGvKHrDYNVJ_3jb6cAKI5VbE4tNLYkVwceR7xWmQ,4508
 zhixuewang/test_student.py,sha256=Fy78zvgwABjfwDvXQDWDRTJFKjrZiJq9KW-bJzDhxbo,2172
 zhixuewang/urls.py,sha256=6N_G7uHUdI_TtfuApKJoA05mCRjlLWGTS5fs0fRhQHU,375
 zhixuewang/zxw.py,sha256=7rKtBHxpgxeqC2N35SG-e97pfbClTD-_XKOIXgHQpWg,8074
 zhixuewang/__pycache__/__init__.cpython-37.pyc,sha256=rwO-pp9sLzCOecKvEZXKg2i1w1gIF95p6Oq2IP5m5Z4,630
-zhixuewang/student/__init__.py,sha256=zdLhnp1u8gJAxG3gkg4L43YI-3T2xr503nzRNQvY2IQ,111
+zhixuewang/student/__init__.py,sha256=1hZ_-EeFM4l7wF8D56jIMigTQ5b7o7sCCTR9_YRjsj0,87
 zhixuewang/student/models.py,sha256=eIhdu6Xn52natbt9mMNLHTfZMK38qktWVuc_iG2WoOM,2165
-zhixuewang/student/student.py,sha256=qNuCgSJg1TTa9pSjKrAZYU0_1hI6oT9khCr-ZGqnE6Y,29296
-zhixuewang/student/urls.py,sha256=hqqOSVHmUVzIs-08rrZhwxjeAav9jUB8KEsdxPQ1mXE,2161
+zhixuewang/student/student.py,sha256=cRO1gSaSWl6p6byMwNhOpknH3sylb9bkBieb0SnI_Hc,23129
+zhixuewang/student/urls.py,sha256=DT-9qktYigS-LZK6J2tCdoc1ZhjRhMO48V8jaHAwm3g,1984
 zhixuewang/teacher/__init__.py,sha256=pfP_DgQdw_UpSTSoV3CTruPX_h0jDeI6P8o13svnMuk,94
-zhixuewang/teacher/models.py,sha256=RwZpBw53UPybYUqQS4QrOxbczpCFyG9hl2wxs5l-RjA,8614
-zhixuewang/teacher/teacher.py,sha256=awf1Xw5tlkTFDgrPwk6GKECOHUrZuX7DItxFYZUB5hY,15591
+zhixuewang/teacher/models.py,sha256=8s8h1VKYVgWt4Z26Js0IoSjtujR0SdWxKI12SHebFEA,831
+zhixuewang/teacher/teacher.py,sha256=ikrQrzka7QWZHJy_0Jae9y-DRHFvF66XI8tKOJJnezM,5888
 zhixuewang/teacher/tools.py,sha256=3w8erBSg3YmQjy8POuPfcIk8lc8xGGYJISA4CLqFUMo,5142
 zhixuewang/teacher/urls.py,sha256=OlubLhPpudaogQNRtjGFoXDUzTSED9Z6dZ3UfVuzB64,1045
 zhixuewang/tools/__init__.py,sha256=uW2PNvEoxlCuojeQIFVyyoLieMOO8PtEz0tSRUxUSqQ,94
 zhixuewang/tools/account.py,sha256=LE774XOul-6hfl8h89GCsDJ6EDLCpJeAMksi0Rju7zg,737
 zhixuewang/tools/cookies.py,sha256=0EOU-pSL9f8nafMXSQiB6NJ0Alk0sepSb3MWn2b2SBM,248
 zhixuewang/tools/datetime_tool.py,sha256=mCsCA0TK27ku4GCQY7ghyruhAeIeN6360jSZZ3XQNqw,433
+zhixuewang/tools/excel_helper.py,sha256=RjIu4JiuqN-fqS9qfQSOZWXVwf-WpxfMnWIER8W2Xqo,2392
 zhixuewang/tools/password_helper.py,sha256=fwrbSs93UmFhIxPI7j1_iAQMTpbqHvBx7OFfNET4BSc,1475
 zhixuewang/tools/rank.py,sha256=JV44hoTOlD2yMA_mq3PehcTyPKVlKjW2S9dmzXu41as,306
 zhixuewang/tools/session.py,sha256=Fl_MMOcuqbGFMKQI9o9wz3XRYHzb5sMIU0ktltw7Lrg,236
-zhixuewang-1.1.7.dist-info/LICENSE,sha256=xfB-JOtu13adc_d9NLglK9fKvZZlHEDoKKpYliTvaQA,1085
-zhixuewang-1.1.7.dist-info/METADATA,sha256=Z1hEhw2XIjlV-SeobhS6WSOJjLL1B91zHEpRzuwEyUg,341
-zhixuewang-1.1.7.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-zhixuewang-1.1.7.dist-info/top_level.txt,sha256=ufrDrdhelpFTIliZw7eEvOtIK_zyIv4UssZNpQqV-Jw,11
-zhixuewang-1.1.7.dist-info/RECORD,,
+zhixuewang-1.1.8.dist-info/LICENSE,sha256=xfB-JOtu13adc_d9NLglK9fKvZZlHEDoKKpYliTvaQA,1085
+zhixuewang-1.1.8.dist-info/METADATA,sha256=CYaYCAsKWUxieU6Rktn6oTYpUQP0Jd1l8P6lJlqqd4U,277
+zhixuewang-1.1.8.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+zhixuewang-1.1.8.dist-info/top_level.txt,sha256=ufrDrdhelpFTIliZw7eEvOtIK_zyIv4UssZNpQqV-Jw,11
+zhixuewang-1.1.8.dist-info/RECORD,,
```

