# Comparing `tmp/odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3-py3-none-any.whl.zip` & `tmp/odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,15 +1,15 @@
-Zip file size: 18055 bytes, number of entries: 13
--rw-r--r--  2.0 unx     1925 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/README.rst
--rw-r--r--  2.0 unx      126 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/__init__.py
--rw-r--r--  2.0 unx      549 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/__manifest__.py
--rw-r--r--  2.0 unx     2936 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/hooks.py
--rw-r--r--  2.0 unx      769 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/i18n/stock_account_prepare_anglo_saxon_out_lines_hook.pot
--rw-r--r--  2.0 unx      130 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/__init__.py
--rw-r--r--  2.0 unx     2087 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/account_move.py
--rw-r--r--  2.0 unx      392 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/account_move_line.py
--rw-r--r--  2.0 unx     9455 b- defN 22-Feb-15 09:59 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/static/description/icon.png
--rw-r--r--  2.0 unx     2539 b- defN 22-Feb-15 09:59 odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Feb-15 09:59 odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-Feb-15 09:59 odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1785 b- defN 22-Feb-15 09:59 odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/RECORD
-13 files, 22790 bytes uncompressed, 14829 bytes compressed:  34.9%
+Zip file size: 18224 bytes, number of entries: 13
+-rw-r--r--  2.0 unx     1925 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/README.rst
+-rw-r--r--  2.0 unx      126 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/__init__.py
+-rw-r--r--  2.0 unx      549 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/__manifest__.py
+-rw-r--r--  2.0 unx     3490 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/hooks.py
+-rw-r--r--  2.0 unx      769 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/i18n/stock_account_prepare_anglo_saxon_out_lines_hook.pot
+-rw-r--r--  2.0 unx      130 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/__init__.py
+-rw-r--r--  2.0 unx     2087 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/account_move.py
+-rw-r--r--  2.0 unx      392 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/account_move_line.py
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jul-06 16:11 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/static/description/icon.png
+-rw-r--r--  2.0 unx     2539 b- defN 23-Jul-06 16:11 odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-06 16:11 odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jul-06 16:11 odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1785 b- defN 23-Jul-06 16:11 odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/RECORD
+13 files, 23344 bytes uncompressed, 14998 bytes compressed:  35.8%
```

## zipnote {}

```diff
@@ -21,20 +21,20 @@
 
 Filename: odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/account_move_line.py
 Comment: 
 
 Filename: odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/static/description/icon.png
 Comment: 
 
-Filename: odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/METADATA
+Filename: odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/METADATA
 Comment: 
 
-Filename: odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/WHEEL
+Filename: odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/WHEEL
 Comment: 
 
-Filename: odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/top_level.txt
+Filename: odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/RECORD
+Filename: odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/__manifest__.py

```diff
@@ -1,14 +1,14 @@
 # Copyright 2020 ForgeFlow S.L.
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
 
 {
     "name": "Stock Account Prepare Anglo Saxon Oout Lines Hook",
     "summary": "Modify when and how anglo saxon journal items are created",
-    "version": "13.0.1.0.3",
+    "version": "13.0.1.0.4",
     "author": "ForgeFlow, Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/account-financial-tools",
     "category": "Generic",
     "depends": ["stock_account"],
     "post_load": "post_load_hook",
     "license": "AGPL-3",
     "installable": True,
```

## odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/hooks.py

```diff
@@ -1,16 +1,19 @@
 # Copyright 2020 ForgeFlow, S.L.
 # License LGPL-3.0 or later (https://www.gnu.org/licenses/lgpl.html).
 
+from odoo.tools import float_is_zero
+
 from odoo.addons.stock_account.models.account_move import AccountMove
 
 
 def post_load_hook():
     def new_stock_account_prepare_anglo_saxon_out_lines_vals(self):
         lines_vals_list = []
+        price_unit_prec = self.env["decimal.precision"].precision_get("Product Price")
         for move in self:
             # Make the loop multi-company safe when accessing models like product.product
             move = move.with_context(force_company=move.company_id.id)
 
             if (
                 not move.is_sale_document(include_receipts=True)
                 or not move.company_id.anglo_saxon_accounting
@@ -38,15 +41,23 @@
                         )
                     else:  # out_invoice/out_receipt
                         credit_expense_account = (
                             move.journal_id.default_debit_account_id
                         )
                 if not debit_interim_account or not credit_expense_account:
                     continue
-
+                # Compute accounting fields.
+                sign = -1 if move.type == "out_refund" else 1
+                price_unit = line._stock_account_get_anglo_saxon_price_unit()
+                balance = sign * line.quantity * price_unit
+
+                if move.currency_id.is_zero(balance) or float_is_zero(
+                    price_unit, precision_digits=price_unit_prec
+                ):
+                    continue
                 # Add interim account line.
                 # SECOND HOOK STARTS
                 if not debit_interim_account or not credit_expense_account:
                     continue
                 interim_account_line_vals = self._prepare_interim_account_line_vals(
                     line, move, debit_interim_account
                 )
```

## Comparing `odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/METADATA` & `odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo13-addon-stock-account-prepare-anglo-saxon-out-lines-hook
-Version: 13.0.1.0.3
+Version: 13.0.1.0.4
 Summary: Modify when and how anglo saxon journal items are created
 Home-page: https://github.com/OCA/account-financial-tools
 Author: ForgeFlow, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/RECORD` & `odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/RECORD`

 * *Files 18% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/README.rst,sha256=9sCjXBurRxBTls_P-bwJz9zb4l8A8ZmbILzX-wdmMVg,1925
 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/__init__.py,sha256=9r635fNTRagS_GbNAwxBAvGp4LGLYP4ljG8Feolgi0k,126
-odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/__manifest__.py,sha256=fWofkxowSYrCXaKR2kV-XGzt_JGlocKVxUyce6mtX-U,549
-odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/hooks.py,sha256=f9-AnLF6225hN0TQBipN2aTpd4WuVIeOvXamAfQ344c,2936
+odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/__manifest__.py,sha256=38ku4iDy2zh3rGn8dBkrltb4zaAwTe4pPkbQNzWzOWw,549
+odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/hooks.py,sha256=yYsSGV_3ww8X8oKQc2JKCEYJiREi-hDuBE3tJLhX_N0,3490
 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/i18n/stock_account_prepare_anglo_saxon_out_lines_hook.pot,sha256=DQ3nnDi7RwrNmTdg8FftTQUFfzHXMFHt8U7tdXZ4kU8,769
 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/__init__.py,sha256=PNAisWYw3gb0Ir9MLq42PRB4vwUiox0eSUfGId1k-_I,130
 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/account_move.py,sha256=v4kEDygZtfwF2nm33k80xC-s70SxMcXOghiF-SQA8oo,2087
 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/models/account_move_line.py,sha256=LOtGOIhc7nFMHeh2qUiLsdW4fSVUDPnDoR4n1vSr32Q,392
 odoo/addons/stock_account_prepare_anglo_saxon_out_lines_hook/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
-odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/METADATA,sha256=yxlQkzOCfJI0L7ElIfBpwzMug_0OIpWOtDEpTkzFXqQ,2539
-odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.3.dist-info/RECORD,,
+odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/METADATA,sha256=kH49LoozSpt-h08hKOpJYgYbGh9WuCj7egensRPLPAw,2539
+odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo13_addon_stock_account_prepare_anglo_saxon_out_lines_hook-13.0.1.0.4.dist-info/RECORD,,
```

