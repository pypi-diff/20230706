# Comparing `tmp/casatestutils-6.5.5.21-py3-none-any.whl.zip` & `tmp/casatestutils-6.5.6.21-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,32 +1,34 @@
-Zip file size: 98260 bytes, number of entries: 30
--rw-r--r--  2.0 unx    17791 b- defN 23-Apr-12 15:04 casatestutils/__init__.py
--rw-r--r--  2.0 unx     3048 b- defN 23-Apr-12 15:04 casatestutils/check.py
--rw-r--r--  2.0 unx    29581 b- defN 23-Apr-12 15:04 casatestutils/compare.py
--rw-r--r--  2.0 unx    53668 b- defN 23-Apr-12 15:04 casatestutils/component_to_test_map.json
--rw-r--r--  2.0 unx    32432 b- defN 23-Apr-12 15:04 casatestutils/extractcasascript.py
--rw-r--r--  2.0 unx    22014 b- defN 23-Apr-12 15:04 casatestutils/filltsys.py
--rw-r--r--  2.0 unx    17848 b- defN 23-Apr-12 15:04 casatestutils/listing.py
--rw-r--r--  2.0 unx    10572 b- defN 23-Apr-12 15:04 casatestutils/restfreqtool.py
--rw-r--r--  2.0 unx    50089 b- defN 23-Apr-12 15:06 casatestutils/runtest.py
--rw-r--r--  2.0 unx    20713 b- defN 23-Apr-12 15:04 casatestutils/selection_syntax.py
--rw-r--r--  2.0 unx    29144 b- defN 23-Apr-12 15:04 casatestutils/testhelper.py
--rw-r--r--  2.0 unx    17977 b- defN 23-Apr-12 15:04 casatestutils/weblog.py
--rw-r--r--  2.0 unx    11485 b- defN 23-Apr-12 15:04 casatestutils/xmlhelper.py
--rw-r--r--  2.0 unx        5 b- defN 23-Apr-12 15:04 casatestutils/datahelpers/__init__.py
--rw-r--r--  2.0 unx     1040 b- defN 23-Apr-12 15:04 casatestutils/datahelpers/getTelescope.py
--rw-r--r--  2.0 unx     2903 b- defN 23-Apr-12 15:04 casatestutils/datahelpers/selectTaql.py
--rw-r--r--  2.0 unx       43 b- defN 23-Apr-12 15:04 casatestutils/imagerhelpers/__init__.py
--rw-r--r--  2.0 unx    55303 b- defN 23-Apr-12 15:04 casatestutils/imagerhelpers/imagetesthelpers.py
--rw-r--r--  2.0 unx        5 b- defN 23-Apr-12 15:04 casatestutils/stakeholder/__init__.py
--rw-r--r--  2.0 unx    34787 b- defN 23-Apr-12 15:04 casatestutils/stakeholder/almastktestutils.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-12 15:04 testrunner/__init__.py
--rw-r--r--  2.0 unx     5141 b- defN 23-Apr-12 15:04 testrunner/run.py
--rw-r--r--  2.0 unx     3208 b- defN 23-Apr-12 15:04 testrunner/shell_runner.py
--rw-r--r--  2.0 unx     1787 b- defN 23-Apr-12 15:04 testrunner/xunit.py
--rw-r--r--  2.0 unx     4226 b- defN 23-Apr-12 15:04 testrunner/xvfb_helper.py
--rw-r--r--  2.0 unx     1122 b- defN 23-Apr-12 15:06 casatestutils-6.5.5.21.dist-info/LICENSE
--rw-r--r--  2.0 unx     8388 b- defN 23-Apr-12 15:06 casatestutils-6.5.5.21.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-12 15:06 casatestutils-6.5.5.21.dist-info/WHEEL
--rw-r--r--  2.0 unx       25 b- defN 23-Apr-12 15:06 casatestutils-6.5.5.21.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2609 b- defN 23-Apr-12 15:06 casatestutils-6.5.5.21.dist-info/RECORD
-30 files, 437046 bytes uncompressed, 94050 bytes compressed:  78.5%
+Zip file size: 111719 bytes, number of entries: 32
+-rw-r--r--  2.0 unx    19319 b- defN 23-Jun-29 16:39 casatestutils/__init__.py
+-rw-r--r--  2.0 unx     3048 b- defN 23-Jun-29 16:39 casatestutils/check.py
+-rw-r--r--  2.0 unx    29581 b- defN 23-Jun-29 16:39 casatestutils/compare.py
+-rw-r--r--  2.0 unx    54328 b- defN 23-Jun-29 16:39 casatestutils/component_to_test_map.json
+-rw-r--r--  2.0 unx    32432 b- defN 23-Jun-29 16:39 casatestutils/extractcasascript.py
+-rw-r--r--  2.0 unx    22014 b- defN 23-Jun-29 16:39 casatestutils/filltsys.py
+-rw-r--r--  2.0 unx    17848 b- defN 23-Jun-29 16:39 casatestutils/listing.py
+-rw-r--r--  2.0 unx    10572 b- defN 23-Jun-29 16:39 casatestutils/restfreqtool.py
+-rw-r--r--  2.0 unx    50928 b- defN 23-Jun-29 17:12 casatestutils/runtest.py
+-rw-r--r--  2.0 unx    20713 b- defN 23-Jun-29 16:39 casatestutils/selection_syntax.py
+-rw-r--r--  2.0 unx    13698 b- defN 23-Jun-29 16:39 casatestutils/sparse_check.py
+-rw-r--r--  2.0 unx    29144 b- defN 23-Jun-29 16:39 casatestutils/testhelper.py
+-rw-r--r--  2.0 unx    18228 b- defN 23-Jun-29 16:39 casatestutils/weblog.py
+-rw-r--r--  2.0 unx    11485 b- defN 23-Jun-29 16:39 casatestutils/xmlhelper.py
+-rw-r--r--  2.0 unx        5 b- defN 23-Jun-29 16:39 casatestutils/datahelpers/__init__.py
+-rw-r--r--  2.0 unx     1040 b- defN 23-Jun-29 16:39 casatestutils/datahelpers/getTelescope.py
+-rw-r--r--  2.0 unx     2903 b- defN 23-Jun-29 16:39 casatestutils/datahelpers/selectTaql.py
+-rw-r--r--  2.0 unx       43 b- defN 23-Jun-29 16:39 casatestutils/imagerhelpers/__init__.py
+-rw-r--r--  2.0 unx    55507 b- defN 23-Jun-29 16:39 casatestutils/imagerhelpers/imagetesthelpers.py
+-rw-r--r--  2.0 unx    33520 b- defN 23-Jun-29 16:39 casatestutils/stakeholder/StkUnitTest.py
+-rw-r--r--  2.0 unx       36 b- defN 23-Jun-29 16:39 casatestutils/stakeholder/__init__.py
+-rw-r--r--  2.0 unx    34787 b- defN 23-Jun-29 16:39 casatestutils/stakeholder/almastktestutils.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-29 16:39 testrunner/__init__.py
+-rw-r--r--  2.0 unx     5141 b- defN 23-Jun-29 16:39 testrunner/run.py
+-rw-r--r--  2.0 unx     3208 b- defN 23-Jun-29 16:39 testrunner/shell_runner.py
+-rw-r--r--  2.0 unx     1787 b- defN 23-Jun-29 16:39 testrunner/xunit.py
+-rw-r--r--  2.0 unx     4226 b- defN 23-Jun-29 16:39 testrunner/xvfb_helper.py
+-rw-r--r--  2.0 unx     1122 b- defN 23-Jun-29 17:12 casatestutils-6.5.6.21.dist-info/LICENSE
+-rw-r--r--  2.0 unx     9617 b- defN 23-Jun-29 17:12 casatestutils-6.5.6.21.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-29 17:12 casatestutils-6.5.6.21.dist-info/WHEEL
+-rw-r--r--  2.0 unx       25 b- defN 23-Jun-29 17:12 casatestutils-6.5.6.21.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2795 b- defN 23-Jun-29 17:12 casatestutils-6.5.6.21.dist-info/RECORD
+32 files, 489192 bytes uncompressed, 107219 bytes compressed:  78.1%
```

## zipnote {}

```diff
@@ -24,14 +24,17 @@
 
 Filename: casatestutils/runtest.py
 Comment: 
 
 Filename: casatestutils/selection_syntax.py
 Comment: 
 
+Filename: casatestutils/sparse_check.py
+Comment: 
+
 Filename: casatestutils/testhelper.py
 Comment: 
 
 Filename: casatestutils/weblog.py
 Comment: 
 
 Filename: casatestutils/xmlhelper.py
@@ -48,14 +51,17 @@
 
 Filename: casatestutils/imagerhelpers/__init__.py
 Comment: 
 
 Filename: casatestutils/imagerhelpers/imagetesthelpers.py
 Comment: 
 
+Filename: casatestutils/stakeholder/StkUnitTest.py
+Comment: 
+
 Filename: casatestutils/stakeholder/__init__.py
 Comment: 
 
 Filename: casatestutils/stakeholder/almastktestutils.py
 Comment: 
 
 Filename: testrunner/__init__.py
@@ -69,23 +75,23 @@
 
 Filename: testrunner/xunit.py
 Comment: 
 
 Filename: testrunner/xvfb_helper.py
 Comment: 
 
-Filename: casatestutils-6.5.5.21.dist-info/LICENSE
+Filename: casatestutils-6.5.6.21.dist-info/LICENSE
 Comment: 
 
-Filename: casatestutils-6.5.5.21.dist-info/METADATA
+Filename: casatestutils-6.5.6.21.dist-info/METADATA
 Comment: 
 
-Filename: casatestutils-6.5.5.21.dist-info/WHEEL
+Filename: casatestutils-6.5.6.21.dist-info/WHEEL
 Comment: 
 
-Filename: casatestutils-6.5.5.21.dist-info/top_level.txt
+Filename: casatestutils-6.5.6.21.dist-info/top_level.txt
 Comment: 
 
-Filename: casatestutils-6.5.5.21.dist-info/RECORD
+Filename: casatestutils-6.5.6.21.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## casatestutils/__init__.py

```diff
@@ -51,15 +51,23 @@
     "accor", "accum", "applycal", "asdmsummary", "bandpass", "blcal", "calstat", "clearcal", "clearstat", "concat", "conjugatevis", "cvel", "cvel2",
     "delmod" ,"exportasdm", "exportfits", "exportuvfits", "feather", "fixplanets", "fixvis", "flagcmd", "flagdata", "flagmanager", "fluxscale", "ft", "gaincal",
     "gencal", "hanningsmooth", "imcollapse", "imcontsub", "imdev", "imfit", "imhead", "imhistory", "immath", "immoments", "impbcor", "importasap", "importasdm",
     "importatca", "importfits", "importfitsidi", "importgmrt", "importmiriad", "importnro", "importuvfits", "importvla", "impv", "imrebin", "imreframe",
     "imregrid", "imsmooth", "imstat", "imsubimage", "imtrans", "imval", "initweights", "listcal", "listfits", "listhistory", "listobs", "listpartition",
     "listsdm", "listvis", "makemask", "mstransform", "partition", "polcal", "polfromgain", "predictcomp", "rerefant", "rmfit", "rmtables", "sdbaseline", "sdcal",
     "sdfit", "sdfixscan", "sdgaincal", "sdimaging", "sdsmooth", "setjy", "simalma", "simanalyze", "simobserve", "slsearch", "smoothcal", "specfit",
-    "specflux", "specsmooth", "splattotable", "split", "spxfit", "statwt", "tclean", "uvcontsub", "uvmodelfit", "uvsub", "virtualconcat", "vishead", "visstat", "widebandpbcor","deconvolve"])
+    "specflux", "specsmooth", "splattotable", "split", "spxfit", "statwt", "tclean", "uvcontsub", "uvmodelfit", "uvsub", "virtualconcat", "vishead", "visstat", "widebandpbcor", "deconvolve"])
+
+# tasks that take a measurement set as the first input
+_vistasks = set([
+    "accor", "apparentsens", "applycal", "bandpass", "blcal", "clearcal", "concat", "conjugatevis", "cvel2", "cvel", "delmod", "exportasdm", "exportuvfits", "fixplanets", "fixvis", "flagcmd",
+    "flagdata", "flagmanager", "fluxscale", "fringefit", "ft", "gaincal", "gencal", "hanningsmooth", "importasdm", "importatca", "importfitsidi", "importgmrt", "importmiriad", "importuvfits",
+    "importvla", "initweights", "listcal", "listhistory", "listobs", "listpartition", "listvis", "mstransform", "partition", "phaseshift", "plotants", "plotbandpass", "plotweather", "polcal",
+    "polfromgain", "rerefant", "sdintimaging", "setjy", "simanalyze", "smoothcal", "split", "statwt", "tclean", "testconcat", "uvcontsub3", "uvcontsub", "uvmodelfit", "uvsub", "virtualconcat",
+    "vishead", "visstat", "widebandpbcor", "nrobeamaverage", "sdatmcor", "sdbaseline", "sdcal", "sdfit", "sdgaincal", "sdpolaverage", "sdsmooth", "sdtimeaverage", "sdimaging", "tsdimaging"])
 
 _miscellaneous_tasks = set(['wvrgcal','plotms'])
 
  
 ############################################################################################
 ##################################       General Functions       ###########################
 ############################################################################################
@@ -120,31 +128,44 @@
                 else:
                     current_case = None
                     #_casa6tasks, _miscellaneous_tasks
             for task in _casa6tasks.union(_miscellaneous_tasks):
                 if current_case == test_case:
                     if "{}(".format(task) in line:
                         #print(line)
-                        taskname = line.split("(")[0]
+                        taskname, parvals = line.split("(", 1)
+                        is_vistask = False
+                        for vistaskname in _vistasks:
+                            if vistaskname in taskname:
+                                is_vistask = True
+                                break
+
                         ## Optional: Can print first index of casa function call but does not print the string name if it's an assigned object
                         ## Attempt to Get Dataset from casa task call
                         if dataset== "TestData":
                             import re
-                            dataset = re.search('(?<=\().+?(?=\,)',line).group()
+                            dataset = re.search('(?<=\().+?(?=\,)',parvals).group()
                             if len(dataset) == 0 or dataset is None:
                                 dataset = "TestData"
-                        params = line.split(',')[1::]
+
+                        params = parvals.split(',')
+                        if is_vistask:
+                            params = params[1:]
                         #print(params)
                         while ')' not in list(line):
                             line = next(file)
                             new_line = [x.strip() for x in line.split(',')]
                             for i in new_line:
                                 params.append(i)
                             params = list(filter(lambda a: a != '', params))
-                        call = "{}({},{}".format(taskname, dataset, ','.join(params))
+
+                        if is_vistask:
+                            call = "{}({},{}".format(taskname, dataset, ','.join(params))
+                        else:
+                            call = "{}({}".format(taskname, ','.join(params))
                         #print(call)
                         func_calls.append(call)
                         #print(func_calls)
     values['runtime'] = -1.0
     #This is a temp error value
     values['status'] = status
     if test_case not in output.keys():
@@ -370,7 +391,8 @@
         #@peakmem(out_dict)
         @mem_use_deco(out_dict)
         @wraps(function)
         def all_wrapped(*args, **kwargs):
             return function(*args, **kwargs)
         return all_wrapped
     return stats_decorator
+
```

## casatestutils/component_to_test_map.json

### Pretty-printed

 * *Similarity: 0.9939024390243902%*

 * *Differences: {"'testlist'": "{insert: [(16, OrderedDict([('testScript', "*

 * *               "'test_stk_vlass_pipeline_imaging_v1.2'), ('testType', 'stakeholder'), "*

 * *               "('maintainer', 'Tak Tsutsumi'), ('maintainerEmail', 'ttsutsum@nrao.edu'), "*

 * *               "('testOptions', ['mpi']), ('testGroup', ['stakeholder']), ('timeout', 14400), "*

 * *               "('comment', '')])), (156, OrderedDict([('testScript', 'test_tool_msuvbinner'), "*

 * *               "('testType', 'casatools'), ('maintainer', 'Kumar Golap'), ('ma […]*

```diff
@@ -201,14 +201,28 @@
             ],
             "testScript": "test_stk_vlass_pipeline_imaging",
             "testType": "stakeholder",
             "timeout": 14400
         },
         {
             "comment": "",
+            "maintainer": "Tak Tsutsumi",
+            "maintainerEmail": "ttsutsum@nrao.edu",
+            "testGroup": [
+                "stakeholder"
+            ],
+            "testOptions": [
+                "mpi"
+            ],
+            "testScript": "test_stk_vlass_pipeline_imaging_v1.2",
+            "testType": "stakeholder",
+            "timeout": 14400
+        },
+        {
+            "comment": "",
             "maintainer": "Neal Schweighart",
             "maintainerEmail": "nschweig@nrao.edu",
             "testGroup": [
                 "accor"
             ],
             "testOptions": [],
             "testScript": "test_task_accor",
@@ -1985,14 +1999,26 @@
             "testOptions": [],
             "testScript": "test_tool_msmetadata",
             "testType": "casatools",
             "timeout": 0
         },
         {
             "comment": "",
+            "maintainer": "Kumar Golap",
+            "maintainerEmail": "kgolap@nrao.edu",
+            "testGroup": [
+                "casatools"
+            ],
+            "testOptions": [],
+            "testScript": "test_tool_msuvbinner",
+            "testType": "casatools",
+            "timeout": 0
+        },
+        {
+            "comment": "",
             "maintainer": "Dave Mehringer",
             "maintainerEmail": "dmehring@nrao.edu",
             "testGroup": [
                 "casatools"
             ],
             "testOptions": [],
             "testScript": "test_tool_quanta",
```

## casatestutils/runtest.py

```diff
@@ -302,21 +302,21 @@
         cwd = os.getcwd()
         os.chdir(run_directory)
         subprocess.call(cmd, stdout = subprocess.DEVNULL, stderr=subprocess.STDOUT)
         os.chdir(cwd)
 
 def is_in_remote(branch,repo_path, repo):
     if branch != 'master':
-        cmd = 'git ls-remote --heads {}{} {} | wc -l'.format(repo_path, repo, branch )
+        cmd = 'git ls-remote --heads {}{} {} | wc -l'.format(repo_path, repo, re.findall("([^\/]+$)",branch )[0])
         #print("\tRunning: ", cmd)
         proc = subprocess.Popen(cmd, stdout=subprocess.PIPE, shell = True)
         out = proc.stdout.read()
         if int(out)== 0: # If Feature Branch Exists Does Not exist, revert to master
             return False
-        else: 
+        else:
             return True
     else:
         return True
 
 def fetch_tests(work_dir, branch, merge_target=None):
 
     if merge_target is not None:
@@ -348,28 +348,34 @@
     repo = "casa6"
     print("Fetching Repository: {}".format(repo))
     cmd = ("git clone " + repo_path + repo).split()
     print("\tRunning: ", " ".join(str(x) for x in cmd))
     run_shell_command(cmd, source_dir)
 
     if merge_target is not None:
-
-        cmd = ("git checkout " + merge_target).split()
+        
+        cmd = ("git checkout origin/{}".format( re.findall("([^\/]+$)",merge_target)[0])).split()
         print("\tRunning: ", " ".join(str(x) for x in cmd))
         run_shell_command(cmd, source_dir + "/" + repo)
 
         if is_in_remote(branch,repo_path, repo): # Test if the branch is in the remote repository
             print("\tMerging {} into {}".format(branch, merge_target))
-            cmd = ("git merge " + branch).split()
+
+            cmd = ("git merge --no-edit --verbose origin/" + re.findall("([^\/]+$)",branch )[0]).split()
             print("\tRunning: ", " ".join(str(x) for x in cmd))
-            run_shell_command(cmd, source_dir + "/" + repo)
+            out = subprocess.check_output(cmd, cwd=source_dir + "/" + repo)
+            print(out.decode("utf-8"))
+
+            print("\tRunning: git status")
+            out = subprocess.check_output(["git", "status"], cwd=source_dir + "/" + repo)
+            print(out.decode("utf-8"))
         else:
             print("\t{} not in Remote Repository {}".format(branch,repo))
     else:
-        cmd = ("git checkout " + branch).split()
+        cmd = ("git checkout origin/{}".format(re.findall("([^\/]+$)",branch )[0])).split()
         if is_in_remote(branch,repo_path, repo):
             print("\tRunning: ", " ".join(str(x) for x in cmd))
         else:
             print("\t{} not in Remote Repository {}. Defaulting to master".format(branch,repo))
         run_shell_command(cmd, source_dir + "/" + repo)
 
     for x in get_repo_test_paths(repo):
@@ -382,48 +388,53 @@
         print("Fetching Repository: {}".format(repo))
         cmd = ("git clone " + repo_path + repo).split()
         print("\tRunning: ", " ".join(str(x) for x in cmd))
         run_shell_command(cmd, source_dir)
 
         if merge_target is not None:
 
-            cmd = ("git checkout " + merge_target).split()
+            cmd = ("git checkout origin/{}".format( re.findall("([^\/]+$)",merge_target)[0])).split()
             print("\tRunning: ", " ".join(str(x) for x in cmd))
             run_shell_command(cmd, source_dir + "/" + repo)
 
             if is_in_remote(branch,repo_path, repo): # Test if the branch is in the remote repository
                 print("\tMerging {} into {}".format(branch, merge_target))
-                cmd = ("git merge " + branch).split()
+                cmd = ("git merge --no-edit --verbose origin/" + re.findall("([^\/]+$)",branch)[0]).split()
                 print("\tRunning: ", " ".join(str(x) for x in cmd))
-                run_shell_command(cmd, source_dir + "/" + repo)
+                out = subprocess.check_output(cmd, cwd=source_dir + "/" + repo)
+                print(out.decode("utf-8"))
+
+                print("\tRunning: git status")
+                out = subprocess.check_output(["git", "status"], cwd=source_dir + "/" + repo)
+                print(out.decode("utf-8"))
             else:
                 print("\t{} not in Remote Repository {}".format(branch,repo))
                 if os.path.isfile(source_dir+"/casa6/build.conf"):
                     print("\tCheckout from build.conf")
                     branchtag = "tags/{}".format(read_conf(source_dir+"/casa6/build.conf")[repo])
                     print("\tTag: " + branchtag)
-                    cmd = ("git checkout " + branchtag).split()
+                    cmd = ("git checkout origin/{}".format(branchtag)).split()
                 else:
                     print("No casa6/build.conf found. Defaulting to master")
-                    cmd = ("git checkout origin/{}".format(merge_target)).split()
+                    cmd = ("git checkout origin/{}".format( re.findall("([^\/]+$)",merge_target)[0])).split()
                 print("\tRunning: ", " ".join(str(x) for x in cmd))
                 run_shell_command(cmd, source_dir + "/" + repo)
 
         else:
 
             # Use Local build.conf to get build tags to git checkout
             if os.path.isfile(source_dir+"/casa6/build.conf"):
                 branchtag = "tags/{}".format(read_conf(source_dir+"/casa6/build.conf")[repo])
                 print("\tTag: " + branchtag)
-                cmd = ("git checkout " + branchtag).split()
+                cmd = ("git checkout origin/{}".format(branchtag)).split()
             else:
                 # Check If Feature Branch Exists
-                if is_in_remote(branch,repo_path, repo): 
-                    cmd = ("git checkout " + branch).split()
-                else: 
+                if is_in_remote(branch,repo_path, repo):
+                    cmd = ("git checkout origin/{}".format( re.findall("([^\/]+$)",branch)[0])).split()
+                else:
                     print("\t{} not in Remote Repository {} Defaulting to master.".format(branch,repo))
                     cmd = ("git checkout origin/master").split()
 
             print("\tRunning: ", " ".join(str(x) for x in cmd))
             run_shell_command(cmd, source_dir + "/" + repo)
 
         for x in get_repo_test_paths(repo):
@@ -464,15 +475,15 @@
             print(" " + d)
             if d.startswith("casa-"):
                 installpath = d
                 print("installpath: " + installpath)
         break
 
     if installpath is None:
-        raise  RuntimeError("Couldn't find a directory that looks like a Casa distribution. Expected directory name to start with 'casa-'")  
+        raise  RuntimeError("Couldn't find a directory that looks like a Casa distribution. Expected directory name to start with 'casa-'")
     return outputdir + "/" + installpath
 
 def get_casatestutils_exec_path(pkg_dir):
     # Since runtest is no longer part of casatestutils, this may be removed.
     for currentpath, folders, files in os.walk(pkg_dir):
         for file in files:
             #print(">>>" + os.path.join(currentpath, file))
@@ -503,15 +514,15 @@
 def write_conftest(conf_name):
     if platform.system() == 'Darwin':
         write_conftest_osx(conf_name)
     else:
         write_conftest_linux(conf_name)
 
 def run_cmd(cmd):
-    try: 
+    try:
         from casampi.MPIEnvironment import MPIEnvironment
         if MPIEnvironment.is_mpi_enabled:
             pytest.main(cmd)
         else:
             subprocess.run([sys.executable,"-m","pytest"] + pytest_args + cmd , env={**os.environ})
     except:
         subprocess.run([sys.executable,"-m","pytest"] + pytest_args + cmd, env={**os.environ})
@@ -827,15 +838,15 @@
         if "mpi" in test.options and sys.platform != "darwin" and ( pmode == 'parallel' or pmode == 'both'):
             print("Running test: {} in MPI mode".format(test.name))
             casa_exe = exec_path + "/mpicasa"
             casaopts = "-n " + str(ncores) + " " + exec_path + "/casa" + " --nogui --nologger --log2term --agg " + rcdir + " "
             assert (test != None)
             cmd = (casa_exe + " " + casaopts + " -c " + test.path).split()
             cwd = work_dir + "/" + test.name
-            if pmode == 'both': 
+            if pmode == 'both':
                 cwd = work_dir + "/" + test.name + '_mpi'
 
             print("Running cmd " + str(cmd) + "in " + cwd)
             if not os.path.exists(cwd):
                 os.makedirs(cwd)
             starttime = datetime.datetime.now()
             output = r.runshell(cmd, test.timeout,cwd)
@@ -1138,15 +1149,15 @@
                             for file in files:
                                 if file.endswith(".py") and file.startswith("test_"):
                                      tests.append(os.path.realpath(os.path.join(root, file)))
                 else:
                     for test_path in test_paths:
                         #print(test_path)
                         for test in testnames:
-                            if not test.endswith(".py"): 
+                            if not test.endswith(".py"):
                                 test = test + ".py"
                             #print(test)
                             for root, dirs, files in os.walk(test_path):
                                 for file in files:
                                     if file == test:
                                         tests.append(os.path.realpath(os.path.join(root, file)))
                 testnames = tests
```

## casatestutils/weblog.py

```diff
@@ -6,14 +6,15 @@
 tb = casatools.table()
 
 class Weblog():
     def __init__(self, taskname, localdict):
         self.localdict = localdict
         self.taskname = taskname
         self.test_counter = 1
+        self.total_runtime = 0
         self.all_passed = True
         #self.html = open("test_{}_weblog.html".format(self.taskname.lower()), 'w')
 
     #def __enter__(self):
     #    return self
 
     #def __exit__(self, *args):
@@ -192,15 +193,18 @@
         self.all_passed = True
         for key, value in dictionary.items():
             if not show_passed:
                 if dictionary[key]['status'] == True:
                     continue
             self.all_passed = False
             Weblog(self.taskname, self.localdict).generate_table_row(str(self.test_counter), str(key), dictionary[key]['description'],  dictionary[key]['runtime'], "tg-ck9b" if dictionary[key]['status'] == True else "tg-r50r" )
+            self.total_runtime += dictionary[key]['runtime']
             self.test_counter += 1
+        Weblog(self.taskname, self.localdict).generate_table_row(str(self.test_counter),'Total', 'Total test runtime', self.total_runtime, "tg-ck9b")
+        
         with open("test_{}_weblog.html".format(self.taskname.lower()), 'a+') as self.html:
             if self.all_passed:
                 self.html.write("<tr>" + "\n")
                 self.html.write('<td class="tg-0lax">All Test Passed</td>' + '\n')
                 self.html.write("</tr>" + "\n")
             self.html.write('</table>' + '\n')
```

## casatestutils/imagerhelpers/imagetesthelpers.py

```diff
@@ -1183,20 +1183,26 @@
         pstr += TestHelpers().check_tabcache(tabcache)
         pstr += TestHelpers().check_stopcode(stopcode, ret)
         pstr += TestHelpers().check_reffreq(reffreq, epsilon=epsilon)
         pstr += TestHelpers().check_tfmask(tfmask)
         return pstr
 
     def check_final(self, pstr=""):
-
         import re
         casalog.post(pstr, 'INFO')
         if len(re.findall(r"\(.?Fail",pstr)) > 0:
             return False
         return True
+
+    def extract_failing_lines(self, pstr=""):
+        import re
+        ret = []
+        for match in re.findall(r"(.*\(.?Fail.*)",pstr):
+            ret.append(match)
+        return os.linesep.join(ret)
         
     def write_file(self,filename,str_text):
         """Save the string in a text file"""
         inp = filename
         cmd = str_text
         # remove file first
         if os.path.exists(inp):
```

## casatestutils/stakeholder/__init__.py

```diff
@@ -1 +1 @@
-pass
+from .StkUnitTest import StkUnitTest
```

## Comparing `casatestutils-6.5.5.21.dist-info/LICENSE` & `casatestutils-6.5.6.21.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `casatestutils-6.5.5.21.dist-info/METADATA` & `casatestutils-6.5.6.21.dist-info/METADATA`

 * *Files 11% similar despite different names*

```diff
@@ -1,30 +1,31 @@
 Metadata-Version: 2.1
 Name: casatestutils
-Version: 6.5.5.21
+Version: 6.5.6.21
 Summary: Tools for use with casatest and testing
 Home-page: https://open-bitbucket.nrao.edu/projects/CASA/repos/casa6/browse
+Download-URL: https://casa.nrao.edu/download/
 Author: A. Wells
 Author-email: awells@nrao.edu
-License: UNKNOWN
-Download-URL: https://casa.nrao.edu/download/
-Description-Content-Type: text/markdown
-Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.6
+Description-Content-Type: text/markdown
+License-File: LICENSE
 Requires-Dist: pytest
 
 # casatestutils Package
-
-## casatestutils 
 A generic testhelper module for use with CASA testing.
 
-Documentation: https://open-confluence.nrao.edu/display/CASA/casatestutils%3A+A+generic+test+helper+module
+Internal documentation: https://open-confluence.nrao.edu/display/CASA/casatestutils%3A+A+generic+test+helper+module
+
+**Table of Contents**
+- [runtest.py](#runtest.py): Wrapper to run tests using pytest
+- [sparse_check.py](#sparse_check.py): Tool to do sparse checkout of data from casatestdata.git
 
 ## runtest.py
 [runtest.py](casatestutils/runtest.py) is a single test wrapper to run CASA Python tests. The script can run one or
 more scripts and will create a directory called ```nosedir``` in the working directory and inside nosedir it will create
 a separated directory with the test name to hold any files created by each test script. 
 
 With the latest version, runtest.py will also create a file called ```short_summary.log``` inside each 
@@ -188,8 +189,37 @@
 
 <tarball>/bin/python3 -m jupyter notebook --generate-config
 
 <tarball>/bin/python3 -m jupyter notebook --browser=firefox --ip='*' --NotebookApp.toke='' --NotebookApp.password='' tests/nb_test_runtest.ipynb
 ```
 Run in [Google Colab](https://colab.research.google.com/drive/1lunhY-8iLot2H0UwFJ98_IWsmBM2TIMd?usp=sharing)
 
+## sparse_check.py
+Download test datasets from casatestdata.git using a sparse checkout. Use it inside a script or
+in the command line. See the usage:
+```
+./python3 sparse_check.py -h
+```
 
+#### from a script
+Import the module to download datasets on-the-fly based on the dataset name stored in casatestdata.git.
+```
+from casatestutils import sparse_check
+sparse_check.download_data(["ngc5921.ms"])
+```
+#### from the command line
+Download datasets used in a specific test script based on the taskname. The script will create a 
+taskname-data file with the contents to be fetched from git and will create a local casatestdata directory
+containing symbolic links to the datasets. Follow the steps below to sparse checkout data for test_task_flagdata.
+```
+./python3 sparse_check.py -j flagdata
+cd casatestdata
+mv ../flagdata-data .
+source flagdata-data
+git checkout master
+cd ../
+```
+With the above steps the datasets needed to run the flagdata tests will be checked out to casatestdata.
+Run the tests in the usual way; for example:
+```
+./python3 ./test_task_flagdata.py
+```
```

## Comparing `casatestutils-6.5.5.21.dist-info/RECORD` & `casatestutils-6.5.6.21.dist-info/RECORD`

 * *Files 11% similar despite different names*

```diff
@@ -1,30 +1,32 @@
-casatestutils/__init__.py,sha256=xY8OgTlTZislWK6q-PUd_2ETfQ41E0MozoaqPhfZWuI,17791
+casatestutils/__init__.py,sha256=OEDLUaiWlFy4tsKFr6P7ZYf67CS9Rjq7_FIR-ortRZM,19319
 casatestutils/check.py,sha256=s3sKmMwlEGtf0FBlVU3renidSj5RXN9JQos-3r2lG-w,3048
 casatestutils/compare.py,sha256=bqntRROlf5jP5NOhAu1FZ6ksYdi7fUTA9DoSIUrbuLQ,29581
-casatestutils/component_to_test_map.json,sha256=mGvg1wxVQVX0Ifcosx0FYxYRifAkNgK8ygpJuRkhHIE,53668
+casatestutils/component_to_test_map.json,sha256=k4CGo7H2gkjkKahMQTjUEbdmfjASsGC8WIlaCJkGStY,54328
 casatestutils/extractcasascript.py,sha256=in6kEU5CJc_pX53uY6I3wd5JFP8cDLxuLJ79ETuISFU,32432
 casatestutils/filltsys.py,sha256=zXMU0uk2QOxS5XTHK2x6g1w9fziH6b1pQ3o-7KqnAoQ,22014
 casatestutils/listing.py,sha256=jco9rQN67ZCD4r5u8YJs6H0WHNyEpIhk3J-QyLlxnlM,17848
 casatestutils/restfreqtool.py,sha256=ubKnOvwhih5juB2x-A70K5WIjeNivYjgbqzrP7t_hE4,10572
-casatestutils/runtest.py,sha256=CN6-W6EVvZpkvQeIum11gl9iJIdZscsm0L_uOOcT9M8,50089
+casatestutils/runtest.py,sha256=LQC_jUp1sZ9HeBgHO4UWMHCLg5pH6fHTNYcYqdzXXIE,50928
 casatestutils/selection_syntax.py,sha256=O6dASZLI-pcSbvf8-rUPINKLNTDtQZ2pNWW8TLI87N8,20713
+casatestutils/sparse_check.py,sha256=prevQNDMhe7mQ5ichFLuxCLoesNmd3ya4vuNOtkM9lY,13698
 casatestutils/testhelper.py,sha256=GRy0nUMRpVwH1b8BY7Jpnsy9Pc1OqEC0KIEMX8Go7dw,29144
-casatestutils/weblog.py,sha256=JxYFAVot01JGK30qMhrz3LbsmjcDUmiUcWC5LIuWIrI,17977
+casatestutils/weblog.py,sha256=Oj9NG4YyF-vndchxfLGMhaiCQ66BrVoghMWj-ADgndI,18228
 casatestutils/xmlhelper.py,sha256=iLsUBaKuOBkEghUKrm8-gGHJ1VBmq5J3qC5RWsbGgHk,11485
 casatestutils/datahelpers/__init__.py,sha256=n1bnYdeb_bNDBKASWGywTRa0Ne9hMAkal3AuVZJgovI,5
 casatestutils/datahelpers/getTelescope.py,sha256=msJABExLjJxIiuZzbiJNpb4rdE0zPlHg5owhXPS7VeQ,1040
 casatestutils/datahelpers/selectTaql.py,sha256=MuCex4bbec_YmxyO8liPUT_IM7h99c_APZYWhEd1CQg,2903
 casatestutils/imagerhelpers/__init__.py,sha256=90ZfSIy0Q2ecEwpQPQWiGGaI9PP326q8VE7K76QWld0,43
-casatestutils/imagerhelpers/imagetesthelpers.py,sha256=HWhSJXksETn7-J5q44DHH36FKjRFFKjpx_XqCQqs1CE,55303
-casatestutils/stakeholder/__init__.py,sha256=n1bnYdeb_bNDBKASWGywTRa0Ne9hMAkal3AuVZJgovI,5
+casatestutils/imagerhelpers/imagetesthelpers.py,sha256=S7CbMjD5kSUe70iCRnQWIRsR7JHfr9niLqJ3V-zQ-xE,55507
+casatestutils/stakeholder/StkUnitTest.py,sha256=zRIx9PTaRV1CLk8f_cOQdXnbLX_RhwQpQUezRpimisQ,33520
+casatestutils/stakeholder/__init__.py,sha256=C7Cz47nAvtBA5xb_pXYGCPTROFjHziVEwqae2sowWU0,36
 casatestutils/stakeholder/almastktestutils.py,sha256=K0P9NJ44YfvNGuoSNrWxm8c6U9Up4ssDqhVGrfwMdNo,34787
 testrunner/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 testrunner/run.py,sha256=dgw4PkVZ2ia2g8e-VlFTGrvbbgLoksj4gjQj-v38e3w,5141
 testrunner/shell_runner.py,sha256=h5UkPmjd-l-HyDZaymdxZtbxsMfgX0p4pcsS5mUHrfs,3208
 testrunner/xunit.py,sha256=LFG9plv4rTM5GCrR_jrq7LrBo25NsAPRAhqsq97XEII,1787
 testrunner/xvfb_helper.py,sha256=U_qD6szFpDHXe1IWen6pVP3Ta5E6r-YSLP52-NK_9lg,4226
-casatestutils-6.5.5.21.dist-info/LICENSE,sha256=6lRsKues2Hi6JpIpPMTMnSQkyHxANFU09cOE8jWmrrQ,1122
-casatestutils-6.5.5.21.dist-info/METADATA,sha256=oZSWWGXZ0H7L0yNqdj3SisoqogUgtStlg-nl-hjz-6U,8388
-casatestutils-6.5.5.21.dist-info/WHEEL,sha256=S8S5VL-stOTSZDYxHyf0KP7eds0J72qrK0Evu3TfyAY,92
-casatestutils-6.5.5.21.dist-info/top_level.txt,sha256=h_oVEqyeArUFdLtN7o4ypbu1Zq4aQZdrQddIBTXvlzY,25
-casatestutils-6.5.5.21.dist-info/RECORD,,
+casatestutils-6.5.6.21.dist-info/LICENSE,sha256=6lRsKues2Hi6JpIpPMTMnSQkyHxANFU09cOE8jWmrrQ,1122
+casatestutils-6.5.6.21.dist-info/METADATA,sha256=7Mr32pB-V7oPt1sIIKH8k4pRohEPjNEwNvZVo-odNBI,9617
+casatestutils-6.5.6.21.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+casatestutils-6.5.6.21.dist-info/top_level.txt,sha256=h_oVEqyeArUFdLtN7o4ypbu1Zq4aQZdrQddIBTXvlzY,25
+casatestutils-6.5.6.21.dist-info/RECORD,,
```

